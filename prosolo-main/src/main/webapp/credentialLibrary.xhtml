<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	template="templates/masterLayout2.xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:courses="http://java.sun.com/jsf/composite/components/courses">

	<ui:define name="windowTitle">
		ProSolo - Competence
	</ui:define>

	<ui:define name="metadata">
		<f:metadata>
			<f:viewAction action="#{credentialLibraryBean.init()}" />
		</f:metadata>
	</ui:define>

    <ui:define name="resourceTitle">
    	<h1>Library</h1>
    </ui:define>
    
    <ui:define name="navLinks">
    	<ul class="nav nav-tabs headerSubmenu">
                <li role="presentation" class="active">
                	<a href="javascript:void(0);">Credentials</a>
                </li>
                <li role="presentation">
                	<a href="#">Competences</a>
                </li>
        </ul>
    </ui:define>
    
	<ui:define name="content">

	<script src="https://use.typekit.net/zvv0dgl.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
    <script src="#{request.contextPath}/resources/javascript2/search.js"></script>

	<h:form id="formMain">
    <p:growl id="growlMain" showDetail="true" globalOnly="true" />
    <div class="whiteBar">
        <div class="container">
            <div class="whiteBarContent">
                <div class="whiteBarLeft">
                    <div class="searchBox">
                    	<p:remoteCommand 
                    		name="execSearchCredentials" 
                    		process=":formMain:inputCredName"
							update=":formMain:panelCredentials :formMain:pagination"
							action="#{credentialLibraryBean.searchCredentials()}" />
						<h:inputText id="inputCredName"
							styleClass="credentialSearchField"
							placeholder="Search Credentials"
							value="#{credentialLibraryBean.searchTerm}"
							onclick="$(this).select();"
							onkeyup="searchListener(execSearchCredentials);">
						</h:inputText>              
                    </div>
                </div>
                <div class="whiteBarRight">
                    <div class="dropdown sortDrop item">
                        <span>Sort:</span>
                        <h:link 
                        	id="linkSortOption" 
                        	pt:data-toggle="dropdown" 
                        	pt:aria-haspopup="true" 
                        	pt:aria-expanded="true">
                            #{credentialLibraryBean.sortOption.label}
                            <span class="arrowDown">arrowDown</span>
                        </h:link>
                        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1">
                        	<ui:repeat var="sortOption" value="#{credentialLibraryBean.sortOptions}">
                        		<li>
	                        		<p:commandLink 
	                        			process="@this"
	                        			value="#{sortOption.label}"
			                        	action="#{credentialLibraryBean.applySortOption(sortOption)}"
			                        	update=":formMain:panelCredentials :formMain:pagination :formMain:linkSortOption">
			                        </p:commandLink>
			                    </li>
                        	</ui:repeat>      
                        </ul>
                    </div>
                    <div class="dropdown showDrop item">
                        <span>Show:</span>
                        <h:link 
                        	id="linkSearchFilter"
                        	pt:data-toggle="dropdown" 
                        	pt:aria-haspopup="true" 
                        	pt:aria-expanded="true">
                            #{credentialLibraryBean.searchFilter.label}
                            <span class="arrowDown">arrowDown</span>
                        </h:link>
                        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1">
                        	<ui:repeat var="searchFilter" value="#{credentialLibraryBean.searchFilters}">
                        		<li>
	                        		<p:commandLink 
	                        			process="@this"
	                        			value="#{searchFilter.label}"
			                        	action="#{credentialLibraryBean.applySearchFilter(searchFilter)}"
			                        	update=":formMain:panelCredentials :formMain:pagination :formMain:linkSearchFilter">
			                        </p:commandLink>
			                	</li>
                        	</ui:repeat>       
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <h:panelGroup layout="block" id="panelCredentials" styleClass="row">
        	<ui:repeat var="cred" value="#{credentialLibraryBean.credentials}">
        		<courses:credentialComp
        			credential="#{cred}"
        			bean="#{credentialLibraryBean}"
        			learningContext="name:library"
        		/>
        	</ui:repeat>   
        </h:panelGroup>

        <utilcomp:pagination
        	id="pagination" 
        	bean="#{credentialLibraryBean}"
        	links="#{credentialLibraryBean.paginationLinks}"
        	toUpdate=":formMain:panelCredentials"
        />

    </div>
    </h:form>

</ui:define>
</ui:composition>
