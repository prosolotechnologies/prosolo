<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:evaluation="http://java.sun.com/jsf/composite/components/evaluation"
	template="templates/masterLayout.xhtml"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util">

	<ui:define name="windowTitle">
		#{msg['evaluation.page.title']} | ProSolo
	</ui:define>

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="id" value="#{newevaluation.evaluationSubmissionId}" />
			
			<f:viewAction action="#{newevaluation.initialize()}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<utilcomp:messagesBundle var="msg" />
	
		<c:if test="#{newevaluation.formData.primeEvaluatedResource.type == 'GOAL'}">
			<evaluation:goalEvaluation id="evaluation" />
		</c:if>
		
		<c:if test="#{newevaluation.formData.primeEvaluatedResource.type == 'ACHIEVED_COMPETENCE' or 
			newevaluation.formData.primeEvaluatedResource.type == 'TARGET_COMPETENCE'}">
			<evaluation:competenceEvaluation id="compEvaluation"/>
		</c:if>
		
		<c:if test="#{newevaluation.formData.primeEvaluatedResource.type == 'EXTERNAL_CREDIT'}">
			<evaluation:exCreditEvaluation />
		</c:if>
		
		<!-- Remove goal dialog -->
		<div id="submitEvaluationDialog" class="submitEvaluationDialog" style="display: none;">
			<h:form id="deleteGoalDialogForm">
				<h4>
					#{evaluation.dialog.submitEvaluationDialog.question}
				</h4>
				
				<p>
					#{msg['evaluation.dialog.submitEvaluationDialog.explanation']}
				</p>
	
				<p:commandLink
					value="Submit"
					styleClass="button green size30 right"
					action="#{newevaluation.submitEvaluation}"
				/>
				<p:commandLink value="Cancel"
					styleClass="button gray size30 right"
					onclick="$('#submitEvaluationDialog').dialog('close');"
			 	/>
		 	</h:form>
		</div>
		
		<script>
		$(function() {
			$('#submitEvaluationDialog').dialog({
				title: "#{msg['evaluation.dialog.submitEvaluationDialog.title']}",
				show : 'slide',
				autoOpen: false,
				width: 400,
				modal: true,
				resizable: false,
			});
			$('#submitEvaluationDialog').show();
		});
		</script>
	</ui:define>
</ui:composition>