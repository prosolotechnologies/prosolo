<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="#{loggeduser.getPublicTemplateForUser()}"
                xmlns:util="http://www.prosolo.com/util"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
                xmlns:assessment="http://java.sun.com/jsf/composite/components/assessments">

    <ui:define name="windowTitle">
        #{profileBean.personalProfile ? '' : profileBean.userData.fullName.concat(' - ')}Profile - ProSolo
    </ui:define>

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="id" value="#{profileBean.studentId}" />
            <f:viewAction action="#{profileBean.init}" />
        </f:metadata>
    </ui:define>

    <ui:define name="resourceTitle">
        <div class="profileHeader">
            <ui:fragment rendered="#{not empty profileBean.userData.avatarUrl}" >
                <img src="#{profileBean.userData.avatarUrl}" class="img-circle" width="120" height="120"
                     alt="#{profileBean.userData.fullName}" />
            </ui:fragment>

            <ui:fragment rendered="#{empty profileBean.userData.avatarUrl}" >
                <span class="letterAvatar letterAvatar120 img-circle">#{util:initials(profileBean.userData.fullName)}</span>
            </ui:fragment>

            <div class="profileHeaderInfo">
                <h1>#{profileBean.userData.fullName}</h1>
                <div>#{profileBean.userData.position}</div>
                <div>#{profileBean.userData.locationName}</div>
                <ul class="socialLinks">
                    <ui:repeat value="#{profileBean.userSocialNetworksData.socialNetworkAccountsData.entrySet().toArray()}"
                               var="socialNetworkData" varStatus="iterator">
                        <ui:fragment rendered="#{not empty socialNetworkData.value.link}" >
                            <li class="#{styleUtilBean.getSocialNetworkClass(socialNetworkData.value.socialNetworkName)}">
                                <a href="#{socialNetworkData.value.link}" target="_blank">#{socialNetworkData.value.socialNetworkName}</a>
                            </li>
                        </ui:fragment>
                    </ui:repeat>
                </ul>
            </div>
            <div class="clear"></div>
        </div>
    </ui:define>

    <ui:define name="content">
        <p:growl id="profileGrowl" showDetail="true" />

        <div class="whiteBar">
            <div class="container">
                <div class="whiteBarContent">
                    <div class="whiteBarLeft">
                        <h:form id="whiteBarProfileForm">
                            <ui:fragment rendered="#{profileBean.personalProfile}" >
                                <p:commandLink
                                        styleClass="btn btn-green btn-sm item"
                                        pt:data-toggle="modal"
                                        value="Add #{msg['label.credential']}"
                                        action="#{profileBean.prepareAddingCredentials()}"
                                        update="profileGrowl :formAddCredentials:panelAddCredentials"
                                        oncomplete="$('#addStandard').modal('show');">
                                </p:commandLink>
                                <h:link outcome="settings" class="btn btn-green-stroke btn-sm">Edit Your Info</h:link>
                            </ui:fragment>

                            <ui:fragment rendered="#{loggeduser.hasCapability('basic.user.access') and not profileBean.personalProfile}" >
                                <p:commandLink id="followButton"
                                               rendered="#{!peopleActionBean.isLoggedUserFollowingUser(profileBean.decodedStudentId)}"
                                               action="#{peopleActionBean.followCollegueById(profileBean.userData.fullName, profileBean.decodedStudentId)}"
                                               update="@form profileGrowl"
                                               process="@this"
                                               styleClass="btn btn-green btn-sm">
                                    <f:param name="page" value="/profile.xhtml" />
                                    <f:param name="learningContext" value="name:profile|id:#{profileBean.decodedStudentId}" />
                                    Follow
                                </p:commandLink>
                                <p:commandLink id="unfollowButton"
                                               rendered="#{peopleActionBean.isLoggedUserFollowingUser(profileBean.decodedStudentId)}"
                                               action="#{peopleActionBean.unfollowCollegueById(profileBean.userData.fullName, profileBean.decodedStudentId)}"
                                               update="whiteBarProfileForm"
                                               process="@form"
                                               styleClass="btn btn-green-stroke btn-sm">
                                    <f:param name="page" value="/profile.xhtml" />
                                    <f:param name="learningContext" value="name:profile|id:#{profileBean.decodedStudentId}" />
                                    Following
                                </p:commandLink>

                                <a href="#" class="btn btn-green btn-sm btnMessage" data-toggle="modal" data-target="#message"><span></span>Message</a>

                                <div class="modal fade" id="message" tabindex="-1" role="dialog" aria-labelledby="sendMessage">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header alignLeft">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                                <h2 class="modal-title" id="sendMessage">Send a Message</h2>
                                            </div>

                                            <div class="messageModalMeta">
                                                <div class="messageModalMetaLine">
                                                    <div class="messageModalMetaLeft">
                                                        To:
                                                    </div>
                                                    <div class="messageModalMetaRight">
                                                        <img src="#{profileBean.userData.avatarUrl}" class="img-circle" width="32" height="32" alt="#{profileBean.userData.fullName}" />
                                                        <h3>#{profileBean.userData.fullName}</h3>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="modal-body alignLeft">
                                                <p:inputTextarea placeholder="Type a message..." value="#{profileBean.message}" id="messageContentTextarea" >
                                                </p:inputTextarea>
                                                <script>try{expandTextarea("messageContentTextarea")}catch(e){}</script>
                                            </div>

                                            <div class="modal-footer alignLeft">
                                                <p:commandLink action="#{profileBean.sendMessage()}"
                                                               styleClass="btn btn-green"
                                                               process="messageContentTextarea"
                                                               update="profileGrowl"
                                                               oncomplete="$('#message').modal('hide');">
                                                    Send
                                                </p:commandLink>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ui:fragment>
                        </h:form>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                <h:panelGroup layout="block" id="panelCredentials" styleClass="col-md-8">
                    <ui:fragment rendered="#{empty profileBean.credentialProfileData}">
                        <div class="noContentMessage">
                            <p> No #{msg['label.credential.plural'].toLowerCase()}. </p>
                        </div>
                    </ui:fragment>
                    <ui:repeat value="#{profileBean.credentialProfileData}" var="credProfileData">
                        <h:panelGroup layout="block" rendered="#{not empty credProfileData.category}" styleClass="categorySeparator">
                            #{credProfileData.category.title}
                        </h:panelGroup>
                        <ui:repeat value="#{credProfileData.credentials}" var="cred">
                            <article class="whiteBox summaryCard summaryCompetence">
                                <div class="innerWrapper">
                                    <h2>
                                        <h:link	outcome="/public-credential">
                                            #{cred.title}
                                            <f:param name="id" value="#{util:encodeId(cred.credentialId)}"/>
                                        </h:link>
                                    </h2>
                                    <ui:fragment rendered="#{profileBean.personalProfile}" >
                                        <div class="dropdown optMoreMenu">
                                            <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">options menu</a>
                                            <ul class="dropdown-menu bullet pull-center" aria-labelledby="dropdownMenu1">
                                                <li>
                                                    <p:commandLink
                                                            value="Edit"
                                                            pt:data-toggle="modal"
                                                            action="#{profileBean.prepareEditCredential(cred)}"
                                                            update="profileGrowl :formEditCredential:panelEditCredential"
                                                            oncomplete="$('#editStandard').modal('show')">
                                                    </p:commandLink>
                                                </li>
                                                <li>
                                                    <p:commandLink
                                                        value="Remove"
                                                        pt:data-toggle="modal"
                                                        action="#{profileBean.prepareRemovingCredentialFromProfile(cred)}"
                                                        oncomplete="$('#removeStandard').modal('show')"
                                                    />
                                                </li>
                                            </ul>
                                        </div>
                                    </ui:fragment>
                                    <div class="clear"></div>
                                    <p class="cardDescription">
                                        #{util:cleanHTMLTags(cred.description)}
                                    </p>
                                    <table class="tableProfile">
                                        <tr>
                                            <td class="col01">Keywords:</td>
                                            <td>
                                                <ul class="tags">
                                                    <ui:repeat value="#{cred.keywords}" var="keyword">
                                                        <li><a>#{keyword}</a></li>
                                                    </ui:repeat>
                                                </ul>
                                            </td>
                                        </tr>
                                    </table>
                                    <div class="metaBox">
                                        <div class="metaLeft">
                                            <table class="tableProfile">
                                                <tr>
                                                    <td class="col01">Completed:</td>
                                                    <td>
                                                        <utilcomp:convertTimeOutput
                                                                millis="#{cred.dateCompleted}"
                                                                format="MMM DD, YYYY"
                                                        />
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="metaRight">
                                            <ui:fragment rendered="#{cred.assessments.count le 0}">
                                                <a class="numberAssessments disabled" data-toggle="tooltip" title="No assessments">assessments</a>
                                            </ui:fragment>
                                            <ui:fragment rendered="#{cred.assessments.count gt 0}">
                                                <p:commandLink
                                                        styleClass="numberAssessments"
                                                        pt:data-toggle="modal"
                                                        action="#{profileBean.initCredentialAssessmentsIfNotInitialized(cred)}"
                                                        update="profileGrowl panelAssessments"
                                                        oncomplete="$('#assessmentsList').modal('show')">
                                                    assessments
                                                </p:commandLink>
                                            </ui:fragment>
                                        </div>
                                    </div>
                                </div>
                                <div class="collapseStandard">
                                    <div id="comp#{cred.credentialProfileConfigId}" class="collapse">
                                        <h:panelGroup id="panelCompList">
                                            <ul>
                                                <ui:repeat value="#{cred.competences.data}" var="comp">
                                                    <li>
                                                        <a>#{comp.title}</a>
                                                        <div class="activityOptions">
                                                            <ui:fragment rendered="#{comp.evidence.count le 0}">
                                                                <a class="numberEvidences disabled" data-toggle="tooltip" title="No evidence">evidences</a>
                                                            </ui:fragment>
                                                            <ui:fragment rendered="#{comp.evidence.count gt 0}">
                                                                <p:commandLink
                                                                        styleClass="numberEvidences"
                                                                        pt:data-toggle="tooltip"
                                                                        pt:title="#{comp.evidence.count} piece#{comp.evidence.count > 1 ? 's' : ''} of evidence"
                                                                        action="#{profileBean.initCompetenceEvidenceIfNotInitialized(comp)}"
                                                                        update="profileGrowl panelCompetenceEvidence"
                                                                        oncomplete="$('#evidencesList').modal('show')">
                                                                    evidences
                                                                </p:commandLink>
                                                            </ui:fragment>
                                                            <ui:fragment rendered="#{comp.assessments.count le 0}">
                                                                <a class="numberAssessments disabled" data-toggle="tooltip" title="No assessments">assessments</a>
                                                            </ui:fragment>
                                                            <ui:fragment rendered="#{comp.assessments.count gt 0}">
                                                                <p:commandLink
                                                                        styleClass="numberAssessments"
                                                                        pt:data-toggle="tooltip"
                                                                        pt:title="#{comp.assessments.count}&#160;assessment#{comp.assessments.count > 1 ? 's' : ''}"
                                                                        action="#{profileBean.initCompetenceAssessmentsIfNotInitialized(comp)}"
                                                                        update="profileGrowl panelAssessments"
                                                                        oncomplete="$('#assessmentsList').modal('show')">
                                                                    assessments
                                                                </p:commandLink>
                                                            </ui:fragment>
                                                        </div>
                                                    </li>
                                                </ui:repeat>
                                            </ul>
                                            <script>
                                                $("[data-toggle='tooltip']").tooltip();
                                            </script>
                                        </h:panelGroup>
                                    </div>
                                    <h:panelGroup id="panelExpandCompetences">
                                        <ui:fragment rendered="#{cred.competences.initialized}">
                                            <a href="#comp#{cred.credentialProfileConfigId}" data-toggle="collapse" class="collapseButton collapsed">
                                                <span class="textShow">Show #{msg['label.competence.plural']}</span>
                                                <span class="arrowDown">down</span>
                                                <span class="textHide">Hide #{msg['label.competence.plural']}</span>
                                                <span class="arrowUp">up</span>
                                            </a>
                                        </ui:fragment>
                                        <p:commandLink
                                                rendered="#{not cred.competences.initialized}"
                                                styleClass="collapseButton collapsed"
                                                process="@this"
                                                action="#{profileBean.initCompetencesIfNotInitialized(cred)}"
                                                update="profileGrowl panelCompList panelExpandCompetences"
                                                oncomplete="$('#comp#{cred.credentialProfileConfigId}').collapse();">
                                            <span class="textShow">Show #{msg['label.competence.plural']}</span>
                                            <span class="arrowDown">down</span>
                                            <span class="textHide">Hide #{msg['label.competence.plural']}</span>
                                            <span class="arrowUp">up</span>
                                        </p:commandLink>
                                    </h:panelGroup>
                                </div>
                            </article>
                        </ui:repeat>
                    </ui:repeat>
                </h:panelGroup>
                <div class="col-md-4">
                    <div class="sidebarBlock">
                        <h:panelGroup layout="block" id="panelStats" styleClass="whiteBox paddingNone sidebarProfileStats">
                            <table>
                                <tr class="row01">
                                    <td class="col01">
                                        <div class="line01">
                                            #{profileBean.getFormattedStatsNumber(profileBean.profileSummaryData.numberOfCompletedCredentials)}
                                        </div>
                                        <div class="line02">
                                            Completed<br/>#{msg['label.credential.plural']}
                                        </div>
                                    </td>
                                    <td class="col02">
                                        <div class="line01">
                                            #{profileBean.getFormattedStatsNumber(profileBean.profileSummaryData.numberOfCompletedCompetencies)}
                                        </div>
                                        <div class="line02">
                                            Completed<br/>#{msg['label.competence.plural']}
                                        </div>
                                    </td>
                                </tr>
                                <tr class="row02">
                                    <td class="col01">
                                        <div class="line01">
                                            #{profileBean.getFormattedStatsNumber(profileBean.profileSummaryData.numberOfAssessments)}
                                        </div>
                                        <div class="line02">
                                            Assessments
                                        </div>
                                    </td>
                                    <td class="col02">
                                        <div class="line01">
                                            #{profileBean.getFormattedStatsNumber(profileBean.profileSummaryData.numberOfPiecesOfEvidence)}
                                        </div>
                                        <div class="line02">
                                            Pieces of Evidence
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </h:panelGroup>
                    </div>
                </div>
            </div>
        </div>

        <h:form id="formAddCredentials">
            <div class="modal fade" id="addStandard" tabindex="-1" role="dialog" aria-labelledby="addStandardModal">
                <div class="modal-dialog" role="document">
                    <h:panelGroup layout="block" id="panelAddCredentials" styleClass="modal-content">
                        <div class="modal-header alignLeft">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                            <h2 class="modal-title" id="addStandardModal">Add #{msg['label.credential']}</h2>
                        </div>
                        <div class="modal-body alignLeft">
                            <ui:fragment rendered="#{not empty profileBean.credentialsToAdd}">
                                <p>Select #{msg['label.credential.plural'].toLowerCase()} that you want to display on your profile page:</p>
                            </ui:fragment>
                            <ui:fragment rendered="#{empty profileBean.credentialsToAdd}">
                                    <p>No #{msg['label.credential.plural'].toLowerCase()} available to add.</p>
                            </ui:fragment>
                            <ui:repeat value="#{profileBean.credentialsToAdd}" var="cred">
                                <div class="checkbox checkLine">
                                    <h:selectBooleanCheckbox id="checkStandard1" value="#{cred.selected}"/>
                                    <h:outputLabel for="checkStandard1" value="#{cred.data.title}"/>
                                </div>
                            </ui:repeat>
                            <ui:fragment rendered="#{not empty profileBean.credentialsToAdd}">
                                <div class="bottom30 top20">
                                    <small>Note: Approved assessments and evidence are not displayed by default. You can select which of them you want to display by choosing the “Edit” option for a #{msg['label.credential'].toLowerCase()}.</small>
                                </div>
                            </ui:fragment>
                        </div>
                        <div class="modal-footer alignLeft">
                            <utilcomp:singleClickLink
                                    rendered="#{not empty profileBean.credentialsToAdd}"
                                    styleClass="btn btn-green"
                                    value="Add"
                                    action="#{profileBean.addCredentials()}"
                                    update="profileGrowl panelCredentials panelStats"
                                    oncomplete="$('#addStandard').modal('hide');"
                            />
                            <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>
                        </div>
                    </h:panelGroup>
                </div>
            </div>
        </h:form>

        <div class="modal fade" id="evidencesList" tabindex="-1" role="dialog" aria-labelledby="evidencesListModal">
            <div class="modal-dialog" role="document">
                <h:panelGroup layout="block" id="panelCompetenceEvidence" styleClass="modal-content">
                    <div class="modal-header alignLeft">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                        <h2 class="modal-title" id="evidencesListModal">Evidence</h2>
                    </div>
                    <div class="assessmentModalMeta">
                        <div class="assessmentModalMetaLine">
                            <div class="assessmentModalMetaLeft">
                                #{msg['label.competence']}:
                            </div>
                            <div class="assessmentModalMetaRight">
                                <h3>#{profileBean.selectedResourceTitle}</h3>
                            </div>
                        </div>
                    </div>
                    <div class="modal-body alignLeft">
                        <div class="evidencesListInModal">
                            <ui:repeat value="#{profileBean.selectedCompetenceEvidences}" var="ev">
                                <div class="evidence">
                                    <div class="evidenceLeft #{ev.type eq 'TEXT' ? 'evidenceText' : styleUtilBean.getEvidenceFileTypeIcon(ev.url)}">
                                        <div class="icon iconType"></div>
                                        <h3>
                                            <h:link outcome="/student-profile-evidence" target="_blank" value="#{ev.title}">
                                                <f:param name="studentId" value="#{util:encodeId(profileBean.ownerOfAProfileUserId)}"/>
                                                <f:param name="competenceEvidenceId" value="#{util:encodeId(ev.competenceEvidenceId)}"/>
                                            </h:link>
                                        </h3>
                                    </div>
                                    <div class="evidenceRight">
                                        <utilcomp:convertTimeOutput
                                                millis="#{ev.dateCreated}"
                                                format="MMM DD, YYYY"/>
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                    </div>
                </h:panelGroup>
            </div>
        </div>

        <div class="modal fade" id="assessmentsList" tabindex="-1" role="dialog" aria-labelledby="assessmentsListModal">
            <div class="modal-dialog" role="document">
                <h:panelGroup layout="block" id="panelAssessments" styleClass="modal-content">
                    <div class="modal-header alignLeft">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                        <h2 class="modal-title" id="assessmentsListModal">Assessments</h2>
                    </div>
                    <div class="assessmentModalMeta">
                        <div class="assessmentModalMetaLine">
                            <div class="assessmentModalMetaLeft">
                                #{profileBean.selectedResourceType eq 'CREDENTIAL' ? msg['label.credential'] : msg['label.competence']}:
                            </div>
                            <div class="assessmentModalMetaRight">
                                <h3>#{profileBean.selectedResourceTitle}</h3>
                            </div>
                        </div>
                    </div>
                    <div class="modal-body alignLeft">
                        <div class="top30"></div>
                        <ul class="nav nav-tabs innerSubmenu" role="tablist">
                            <ui:repeat value="#{profileBean.selectedResourceAssessmentsByType}" var="assessmentType" varStatus="status">
                                <li role="presentation" class="#{profileBean.isAssessmentTabInitiallyActive(assessmentType.assessmentType) ? 'active' : ''}">
                                    <a href="#assessmentsContent#{status.index}" aria-controls="assessmentsContent#{status.index}" role="tab" data-toggle="tab">#{msg['label.assessment.type.'.concat(assessmentType.assessmentType).concat('.plural')]}</a>
                                </li>
                            </ui:repeat>
                        </ul>
                        <div class="tab-content">
                            <ui:repeat value="#{profileBean.selectedResourceAssessmentsByType}" var="assessmentType" varStatus="status">
                                <div role="tabpanel" class="tab-pane fade #{profileBean.isAssessmentTabInitiallyActive(assessmentType.assessmentType) ? 'active in' : ''}" id="assessmentsContent#{status.index}">
                                    <div class="assessmentsListInModal">
                                        <ui:repeat value="#{assessmentType.assessments}" var="assessment">
                                            <div class="assessmentItem">
                                                <div class="assessmentLeft">
                                                    <div class="assessmentsStar #{styleUtilBean.getGradeStarClass(assessment.assessmentGradeSummary)}">
                                                        <div class="star #{styleUtilBean.getEmptyStarClass(assessment.assessmentGradeSummary)}"></div>
                                                    </div>
                                                    <div class="user32">
                                                        <assessment:assessmentActorAvatar
                                                                actorId="#{assessment.userBasicData.id}"
                                                                avatarUrl="#{assessment.userBasicData.avatar}"
                                                                actorFullName="#{assessment.userBasicData.fullName}"
                                                                blindAssessmentMode="#{assessment.blindAssessmentMode}"
                                                                actorType="ASSESSOR"
                                                        />
                                                        <h3>
                                                            <assessment:assessmentActorName
                                                                    actorId="#{assessment.userBasicData.id}"
                                                                    actorFullName="#{assessment.userBasicData.fullName}"
                                                                    blindAssessmentMode="#{assessment.blindAssessmentMode}"
                                                                    actorType="ASSESSOR"
                                                            />
                                                        </h3>
                                                    </div>
                                                </div>
                                                <div class="assessmentRight">
                                                    <utilcomp:convertTimeOutput
                                                            millis="#{assessment.dateApproved}"
                                                            format="MMM DD, YYYY"
                                                    />
                                                </div>
                                            </div>
                                        </ui:repeat>
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                    </div>
                </h:panelGroup>
            </div>
        </div>

        <h:form id="formEditCredential">
            <div class="modal fade" id="editStandard" tabindex="-1" role="dialog" aria-labelledby="editStandardModal">
                <div class="modal-dialog modal-lg">
                    <h:panelGroup id="panelEditCredential" layout="block" styleClass="modal-content">
                        <div class="modal-header alignLeft">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                            <h2 class="modal-title">#{not empty profileBean.credentialForEdit ? profileBean.credentialForEdit.title : 'Error occurred'}</h2>
                        </div>
                        <div class="modal-body alignLeft">
                            <ui:fragment rendered="#{not empty profileBean.credentialForEdit}">
                                <p>Select approved #{msg['label.assessment.type.INSTRUCTOR_ASSESSMENT.short'].toLowerCase()}, #{msg['label.assessment.type.PEER_ASSESSMENT.short'].toLowerCase()} or #{msg['label.assessment.type.SELF_ASSESSMENT.short'].toLowerCase()} assessments for the #{msg['label.credential'].toLowerCase()} you want to be displayed on your profile:</p>

                                <div class="standardInModal bottom30">
                                    <ui:fragment rendered="#{profileBean.totalNumberOfCredentialAssessmentsAvailableToAdd eq 0}">
                                    <div class="lightText">
                                        No approved #{msg['label.credential'].toLowerCase()} assessments
                                    </div>
                                    </ui:fragment>
                                    <ui:repeat value="#{profileBean.credentialForEdit.assessments}" var="assessmentType" varStatus="status">
                                        <ui:fragment rendered="#{not empty assessmentType.assessments}">
                                            <div class="checkbox checkLine">
                                                <h:selectBooleanCheckbox id="checkCredentialAssessments" binding="#{checkAllCredAssessmentsComp}" checked="#{util:areAllItemsSelected(assessmentType.assessments)}"/>
                                                <h:outputLabel for="checkCredentialAssessments" value="#{msg['label.assessment.type.'.concat(assessmentType.assessmentType.name()).concat('.plural')]}:"/>
                                            </div>
                                            <div class="assessmentsListInModal">
                                                <ui:repeat value="#{assessmentType.assessments}" var="assessment" varStatus="statusAssessment">
                                                    <div class="assessmentItem">
                                                        <div class="assessmentLeft">
                                                            <div class="subIndicator"></div>
                                                            <div class="checkbox">
                                                                <h:selectBooleanCheckbox
                                                                        id="checkCredentialAssessment"
                                                                        value="#{assessment.selected}"
                                                                        pt:data-check-id="#{checkAllCredAssessmentsComp.clientId}"/>
                                                                <h:outputLabel for="checkCredentialAssessment"/>
                                                            </div>
                                                            <div class="assessmentsStar #{styleUtilBean.getGradeStarClass(assessment.data.assessmentGradeSummary)}">
                                                                <div data-html="true" data-toggle="tooltip" title="#{styleUtilBean.getGradePercentage(assessment.data.assessmentGradeSummary)}"  class="star #{styleUtilBean.getEmptyStarClass(assessment.data.assessmentGradeSummary)}"></div>
                                                            </div>
                                                            <div class="user32">
                                                                <assessment:assessmentActorAvatar
                                                                        actorId="#{assessment.data.userBasicData.id}"
                                                                        avatarUrl="#{assessment.data.userBasicData.avatar}"
                                                                        actorFullName="#{assessment.data.userBasicData.fullName}"
                                                                        blindAssessmentMode="#{assessment.data.blindAssessmentMode}"
                                                                        actorType="ASSESSOR"
                                                                />
                                                                <h3>
                                                                    <assessment:assessmentActorName
                                                                            actorId="#{assessment.data.userBasicData.id}"
                                                                            actorFullName="#{assessment.data.userBasicData.fullName}"
                                                                            blindAssessmentMode="#{assessment.data.blindAssessmentMode}"
                                                                            actorType="ASSESSOR"
                                                                    />
                                                                </h3>
                                                            </div>
                                                        </div>
                                                        <div class="assessmentRight">
                                                            <utilcomp:convertTimeOutput
                                                                    millis="#{assessment.data.dateApproved}"
                                                                    format="MMM DD, YYYY"
                                                            />
                                                        </div>
                                                    </div>
                                                </ui:repeat>
                                            </div>
                                            <script>
                                                bindCheckAllOnclick(escapeColons('#{checkAllCredAssessmentsComp.clientId}'));
                                            </script>
                                        </ui:fragment>
                                    </ui:repeat>
                                </div>

                                <h2>#{msg['label.competence.plural']}</h2>

                                <p>Select evidence and approved assessments you want to be displayed on your profile for each of the #{msg['label.competence.plural'].toLowerCase()}:</p>

                                <ui:repeat value="#{profileBean.credentialForEdit.competences}" var="comp" varStatus="status">
                                    <div class="standardInModal bottom30">
                                        <h3>#{comp.title}</h3>
                                        <ui:fragment rendered="#{empty comp.evidence}">
                                            <div class="lightText">No evidence</div>
                                        </ui:fragment>
                                        <ui:fragment rendered="#{not empty comp.evidence}">
                                            <div class="checkbox checkLine">
                                                <h:selectBooleanCheckbox id="checkPiecesOfEvidence" binding="#{checkAllCompEvidenceComp}" checked="#{util:areAllItemsSelected(comp.evidence)}"/>
                                                <h:outputLabel for="checkPiecesOfEvidence" value="Evidence:"/>
                                            </div>
                                            <div class="evidencesListInModal">
                                                <ui:repeat value="#{comp.evidence}" var="evidence" varStatus="statusEvidence">
                                                    <div class="evidence">
                                                        <div class="evidenceLeft #{evidence.data.type eq 'TEXT' ? 'evidenceText' : styleUtilBean.getEvidenceFileTypeIcon(evidence.data.url)}">
                                                            <div class="subIndicator"></div>
                                                            <div class="checkbox">
                                                                <h:selectBooleanCheckbox
                                                                        id="checkEvidence"
                                                                        value="#{evidence.selected}"
                                                                        pt:data-check-id="#{checkAllCompEvidenceComp.clientId}"
                                                                />
                                                                <h:outputLabel for="checkEvidence"/>
                                                            </div>
                                                            <div class="icon iconType"></div>
                                                            <h3>#{evidence.data.title}</h3>
                                                        </div>
                                                        <div class="evidenceRight">
                                                            <utilcomp:convertTimeOutput
                                                                    millis="#{evidence.data.dateCreated}"
                                                                    format="MMM DD, YYYY"/>
                                                        </div>
                                                    </div>
                                                    <script>
                                                        bindCheckAllOnclick(escapeColons('#{checkAllCompEvidenceComp.clientId}'));
                                                    </script>
                                                </ui:repeat>
                                            </div>
                                        </ui:fragment>
                                        <ui:fragment rendered="#{profileBean.getTotalNumberOfCompetenceAssessmentsAvailableToAdd(comp) eq 0}">
                                            <div class="lightText">
                                                No approved #{msg['label.competence'].toLowerCase()} assessments
                                            </div>
                                        </ui:fragment>
                                        <ui:repeat value="#{comp.assessments}" var="assessmentType" varStatus="status">
                                            <ui:fragment rendered="#{not empty assessmentType.assessments}">
                                                <div class="checkbox checkLine">
                                                    <h:selectBooleanCheckbox id="checkCompetenceAssessments" binding="#{checkAllCompAssessmentsComp}" checked="#{util:areAllItemsSelected(assessmentType.assessments)}"/>
                                                    <h:outputLabel for="checkCompetenceAssessments" value="#{msg['label.assessment.type.'.concat(assessmentType.assessmentType.name()).concat('.plural')]}:"/>
                                                </div>
                                                <div class="assessmentsListInModal">
                                                    <ui:repeat value="#{assessmentType.assessments}" var="assessment" varStatus="statusAssessment">
                                                        <div class="assessmentItem">
                                                            <div class="assessmentLeft">
                                                                <div class="subIndicator"></div>
                                                                <div class="checkbox">
                                                                    <h:selectBooleanCheckbox
                                                                            id="checkCompetenceAssessment"
                                                                            value="#{assessment.selected}"
                                                                            pt:data-check-id="#{checkAllCompAssessmentsComp.clientId}"/>
                                                                    <h:outputLabel for="checkCompetenceAssessment"/>
                                                                </div>
                                                                <div class="assessmentsStar #{styleUtilBean.getGradeStarClass(assessment.data.assessmentGradeSummary)}">
                                                                    <div data-html="true" data-toggle="tooltip" title="#{styleUtilBean.getGradePercentage(assessment.data.assessmentGradeSummary)}"  class="star #{styleUtilBean.getEmptyStarClass(assessment.data.assessmentGradeSummary)}"></div>
                                                                </div>
                                                                <div class="user32">
                                                                    <assessment:assessmentActorAvatar
                                                                            actorId="#{assessment.data.userBasicData.id}"
                                                                            avatarUrl="#{assessment.data.userBasicData.avatar}"
                                                                            actorFullName="#{assessment.data.userBasicData.fullName}"
                                                                            blindAssessmentMode="#{assessment.data.blindAssessmentMode}"
                                                                            actorType="ASSESSOR"
                                                                    />
                                                                    <h3>
                                                                        <assessment:assessmentActorName
                                                                                actorId="#{assessment.data.userBasicData.id}"
                                                                                actorFullName="#{assessment.data.userBasicData.fullName}"
                                                                                blindAssessmentMode="#{assessment.data.blindAssessmentMode}"
                                                                                actorType="ASSESSOR"
                                                                        />
                                                                    </h3>
                                                                </div>
                                                            </div>
                                                            <div class="assessmentRight">
                                                                <utilcomp:convertTimeOutput
                                                                        millis="#{assessment.data.dateApproved}"
                                                                        format="MMM DD, YYYY"
                                                                />
                                                            </div>
                                                        </div>
                                                    </ui:repeat>
                                                </div>
                                                <script>
                                                    bindCheckAllOnclick(escapeColons('#{checkAllCompAssessmentsComp.clientId}'));
                                                </script>
                                            </ui:fragment>
                                        </ui:repeat>
                                    </div>
                                </ui:repeat>
                            </ui:fragment>
                        </div>
                        <ui:fragment rendered="#{not empty profileBean.credentialForEdit}">
                            <div class="modal-footer alignLeft">
                                <utilcomp:singleClickLink
                                        id="linkUpdateCred"
                                        styleClass="btn btn-green"
                                        value="Done"
                                        action="#{profileBean.updateCredentialProfileOptions()}"
                                        update="profileGrowl panelCredentials panelStats"
                                        oncomplete="$('#editStandard').modal('hide');"
                                />
                                <p:defaultCommand target="linkUpdateCred"/>
                                <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>
                            </div>
                        </ui:fragment>
                    </h:panelGroup>
                </div>
            </div>
        </h:form>

        <div class="modal fade" id="removeStandard" tabindex="-1" role="dialog" aria-labelledby="removeStandardModal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                        <h2 class="modal-title" id="removeStandardModal">Remove #{msg['label.credential']}?</h2>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure you want to remove this #{msg['label.credential'].toLowerCase()} from your profile page?</p>
                    </div>
                    <div class="modal-footer">
                        <utilcomp:singleClickLink
                                styleClass="btn btn-red"
                                value="Remove"
                                action="#{profileBean.removeCredentialFromProfile()}"
                                update="profileGrowl panelCredentials panelStats"
                                oncomplete="$('#removeStandard').modal('hide');"
                        />
                        <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>
                    </div>
                </div>
            </div>
        </div>

		<script>
			$(function () {
                $('#message').on('shown.bs.modal', function() {
                    $('#'+escapeColons('whiteBarProfileForm:messageContentTextarea')).focus();
                }).on('hidden.bs.modal', function() {
                    $('#'+escapeColons('whiteBarProfileForm:messageContentTextarea')).val('');
                });
            })
		</script>

    </ui:define>
</ui:composition>