<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:p="http://primefaces.org/ui">
	
<h:head>
	<meta http-equiv="content-type" content="text/html" charset="UTF-8"/>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" media="all" href="#{request.contextPath}/resources/css/style.css?#{loggeduser.loginTime}" />
	<link rel="icon" href="#{request.contextPath}/favicon.ico" type="image/x-icon" />
	<title>Login | ProSolo</title>
</h:head>

<f:view contentType="text/html">
	<script>
		$(function() {
		    $('form:first input[type!=hidden]:first').focus();
		});
		
		function showLoader() {
			$('#loginloader').show();
		}
	</script>
	
	<f:metadata>
    	<f:event type="preRenderView" listener="#{loggeduser.checkIfLoggedIn}" />
	</f:metadata>

	<div class="signContainer">
		<div class="signTop">
			<h1>
				<h:link outcome="/login">
					<span class="logo"></span>
				</h:link>
			</h1>
		</div>
		
		<div class="signMain">
			<h2 style="text-align: center;">Login</h2>
			
			<c:if test="#{applicationbean.config.application.maintenance}">
				<div class="infoBlockYellowMessage maintenance">
					The server is presently under maintenance and you can
					experience some unexpected issues with the use of Pro Solo. The
					maintenance will be finished within next few hours. We are sorry for
					any inconvenience caused.
				</div>
			</c:if>
			<!--[if lt IE 9]>
				<div class="infoBlockYellowMessage"> 
					Please note that ProSolo is not optimized for Internet Explorer 7 and 8. 
					As a consequence, some functionalities may not work properly and the design
					may be broken.
				</div>
			< ![endif]-->
		
			<c:if test="#{applicationbean.config.application.registration.google or 
						applicationbean.config.application.registration.edx}">
				<h:form prependId="false" id="openFormId">
					<div class="openIdProviders">
						<c:if test="#{applicationbean.config.application.registration.google}">
						    <h:commandLink
				            	id="openidGmail" 
				            	class="google"
				            	action="#{openid.signinOpenidGoogle}" 
				            />
						</c:if>
						
						<c:if test="#{applicationbean.config.application.registration.edx}">
				            <h:commandLink
				            	id="openidEdx" 
				            	class="edx"
				            	action="#{openid.signinOpenidEdx}" 
				            />
			            </c:if>
					 </div>
				</h:form>
			</c:if>
			
			<c:if test="#{(applicationbean.config.application.registration.google or 
							applicationbean.config.application.registration.edx) and 
						applicationbean.config.application.registration.selfRegistration}">
				<div class="signInSeparator">
					<span>Or sign in with your email</span>
				</div>
			</c:if>
		
			<c:if test="#{applicationbean.config.application.registration.selfRegistration}">
				<h:form  prependId="false">
					<p:messages id="loginMessage" showDetail="false" autoUpdate="true" closable="true" />

					<table>
						<tr>
							<td class="col1">
								<label>Email:</label>
							</td>
							<td>
								<h:inputText type="email"  value="#{loggeduser.email}" required="true" requiredMessage="Email is required." />
							</td>
						</tr>
						<tr>
							<td class="col1">
								<label>Password:</label>
							</td>
							<td>
								<h:inputSecret  value="#{loggeduser.password}" required="true" requiredMessage="Password is required." />
							</td>
						</tr>
						<tr>
							<td class="col1">
							</td>
							<td>
								<label class="right"><input type="checkbox"/> Remember me</label>
								<h:commandButton id="loginButton" action="#{loggeduser.login}" type="submit" class="button blue size30 left" value="Login" onclick="showLoader();"/>
								<img class="loader left marginLeft10" src="#{request.contextPath}/resources/images/style/ajax-loader-black.gif" id="loginloader" />
							</td>
						</tr>
					</table>
				
					<div class="clear"></div>
					
					<div class="buttonsLine">
					</div>
					<div class="center clear">
						<h:link value="Forgot password?" outcome="/passwordReset" />
					</div>
				</h:form>
			</c:if>
		</div><!-- .main end -->
		
		<div class="clear"></div>
	</div><!-- .signContainer end -->
	
	<comp:footer styleClass="public" />
</f:view>
</html>

	