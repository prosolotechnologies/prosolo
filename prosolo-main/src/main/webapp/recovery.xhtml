<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:p="http://primefaces.org/ui">

	<h:head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script src="#{request.contextPath}/resources/javascript/jquery.passwordstrength.custom.js"></script>
		<link rel="stylesheet" type="text/css" media="all" href="#{request.contextPath}/resources/css/style.css" />
		<link rel="icon" href="#{request.contextPath}/favicon.ico" type="image/x-icon" />
		<title>Password Recovery | ProSolo</title>
	</h:head>

	<f:view>
		<f:metadata>
			<f:viewParam name="key" value="#{passwordrecovery.key}"  />
		</f:metadata>
			
		<h:form id="passwordRecoveryForm">
			<div class="signContainer passwordRecovery">
				<div class="signTop">
					<h1>
						<h:link outcome="/login">
							<span class="logo"></span>
						</h:link>
					</h1>
				</div>
				
				<div class="signMain">
					<h2 style="text-align: center;">Password Recovery</h2>
	
					<h:panelGroup layout="block" rendered="#{!passwordrecovery.linkValid}">
						This link has expired. Please reset your password again
						<h:link value="here" outcome="/passwordReset" />.
					</h:panelGroup>
					
					<h:panelGroup layout="block" rendered="#{passwordrecovery.linkValid}">
						<table>
							<tr>
								<td class="col1">
									<label>New password:</label>
								</td>
								<td>
									<span class="passwordWrapper">
										<p:password id="password" name="password" 
											value="#{passwordrecovery.newPass}" 
											required="true" 
											label="New password" 
											match="passwordConfirm" />
									</span>
								</td>
							</tr>
							<tr>
								<td class="col1">
									<label>Confirm password:</label>
								</td>
								<td>
									<p:password id="passwordConfirm" name="passwordConfirm" 
										label="Confirmed password" 
										required="true" />
									
								</td>
							</tr>
						</table>
						
						<div class="buttonsLine">
							<p:messages id="messages" showDetail="true" autoUpdate="true"/>  
							<p:commandLink 
								value="Reset" 
								action="#{passwordrecovery.login}" 
								update="passwordRecoveryForm" 
								styleClass="button blue size30 right" 
								/>
							<h:link styleClass="button gray size30 left" value="Back" outcome="/login" />
							
							<script>
								$(function() {
									if (#{passwordrecovery.toRedirect}) {
										window.location.href = "index";
									}
								});
							</script>
						</div>
					</h:panelGroup>
				</div><!-- .main end -->
	
				<div class="clear"></div>
			</div><!-- .signContainer end -->
		</h:form>
		
		<script>
			$(function(){
				$('#passwordRecoveryForm\\:password').passStrength({
					username: '#{passwordrecovery.user.name} #{passwordrecovery.user.lastname}',
					baseStyle: 'passStrength'
				});
				
			});
		</script>
		
		<comp:footer styleClass="public" />
	</f:view>
</html>	