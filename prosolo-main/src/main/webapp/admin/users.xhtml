<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="templates/masterLayout2.xhtml"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:courses="http://java.sun.com/jsf/composite/components/courses"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util">

<ui:define name="windowTitle">
	ProSolo - Admin | Users
</ui:define>

<ui:define name="metadata">
	<f:metadata>

	</f:metadata>
</ui:define>

<ui:define name="content">
<script src="#{request.contextPath}/resources/javascript2/search.js"></script>
	<p:growl id="growlMain" showDetail="true" globalOnly="true"></p:growl>
    <div class="whiteBar">
        <div class="container">
            <div class="whiteBarContent">
                <div class="whiteBarLeft">
                    <h:link outcome="/admin/userEdit" styleClass="btn btn-green btn-sm item">New User</h:link>
                    <div class="searchBox">
                    	<h:form>
                    		<p:remoteCommand 
								name="execSearchUsers" 
								process="inputUserSearch"
								update=":panelUsers :pagination"
								action="#{adminUsers.resetAndSearch()}" />
														
							<h:inputText id="inputUserSearch"
								type="search"
								placeholder="Filter by Keywords"
								value="#{adminUsers.searchTerm}"
								onclick="$(this).select();"
								onkeyup="searchListener(execSearchUsers);"/> 
                    	</h:form>
                    </div>
                </div>
                <div class="whiteBarRight">
                    <div class="dropdown showDrop item">
                        <span>Show:</span>
                        <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            All (11)
                            <span class="arrowDown">arrowDown</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1">
                            <li><a href="#">All (10)</a></li>
                            <li><a href="#">Users (4)</a></li>
                            <li><a href="#">Instructors (2)</a></li>
                            <li><a href="#">Managers (3)</a></li>
                            <li><a href="#">Admins (2)</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <h:panelGroup layout="block" id="panelUsers" styleClass="col-md-12">
                <ul class="whiteBox peopleList">
                	<ui:repeat var="user" value="#{adminUsers.users}">
	                    <li>
	                        <div class="peopleListLeft">
	                        	<h:link outcome="/admin/userEdit">
			                   		<utilcomp:userAvatar
										avatar="#{user.avatarUrl}"
										fullName="#{user.fullName}"	
										width="64"
										height="64"
								    />    
								    <f:param name="id" value="#{util:encodeId(user.id)}"></f:param>
			                    </h:link>
	                            
	                            <div>
	                                <h2>
	                                	<h:link outcome="/admin/userEdit">
					                   		#{user.fullName}    
								    		<f:param name="id" value="#{util:encodeId(user.id)}"></f:param>
			                    		</h:link>
			                    	</h2>
	                                <span>#{user.position}</span>
	                            </div>
	                        </div>
	                        <div class="peopleListRight">
	                            <div class="userRole">
	                                #{user.rolesCSV}
	                            </div>
	                            <div class="userEditOpt">
	                                <h:link outcome="/admin/userEdit" styleClass="btn btn-green-stroke">
		                                 <f:param name="id" value="#{util:encodeId(user.id)}"/>
		                               	 Edit
	                                </h:link>
	                                <p:commandLink 
	                                	styleClass="linkRed"
	                                	pt:data-toggle="modal"
	                                	action="#{adminUsers.setUserToDelete(user)}"
	                                	update=":deleteUserModal"
	                                	oncomplete="$('#deleteModal').modal('show');">
	                                	Delete
	                                </p:commandLink>
	                            </div>
	                        </div>
	                    </li>
                    </ui:repeat>
                </ul>
            </h:panelGroup>
        </div>

        <utilcomp:pagination
				id="pagination" 
				bean="#{adminUsers}"
				links="#{adminUsers.paginationLinks}"
				toUpdate=":panelUsers" />
    </div>

	<courses:deleteModalDialog id="deleteUserModal"
   			deleteActionMethodName="delete"     	
          	deleteAction="#{adminUsers.delete}"
          	toUpdate=":panelUsers :growlMain" 
          	modalDeleteTitle="user"
          	modalDeleteText="#{adminUsers.userToDelete.fullName}"/>
  </ui:define>
</ui:composition>
