<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:goalscomps="http://java.sun.com/jsf/composite/components/goals">
<body>
	<ui:composition xmlns:dlg="http://java.sun.com/jsf/composite/components/admin/dialogs">

		<div id="unitFormContainer" class="content wide">
			<dlg:newUnit id="newUnit" regionToUpdate=":unitsForm :unitSubUnits:unitSubUnitsForm"/>
			<dlg:editUnit id="editUnit" regionToUpdate=":unitsForm :unitSubUnits:unitSubUnitsForm"/>
			<dlg:unitUsers id="unitUsers" />
			<dlg:unitSubUnits id="unitSubUnits" />
			<dlg:unitUserRoles id="unitUserRoles" />

			<h:form id="unitsForm" prependId="false">

				<p:dataTable id="unitsDataTable" var="unit" value="#{units.units}">
					<f:facet name="header">Units</f:facet>
					<p:column id="nameColumn" filterBy="#{unit.name}"
						filterMatchMode="contains" sortBy="#{unit.name}">
						
						<f:facet name="header">
							<h:outputText value="Name" />
						</f:facet>
						<h:outputText value="#{unit.name}" />
					</p:column>

					<p:column filterBy="#{unit.parentName}" filterMatchMode="contains"
						sortBy="#{unit.parentName}">
						<f:facet name="header">
							<h:outputText value="Parent Unit" />
						</f:facet>
						<h:outputText value="#{unit.parentName}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Description" />
						</f:facet>
						<h:outputText value="#{unit.description}" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Edit" />
						</f:facet>
						<p:commandLink value="Edit"
							onclick='$("#editUnitModalDialog").dialog("open");'
							action="#{units.prepareEditUnit(unit)}"
							update=":editUnit:editUnitForm" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Users" />
						</f:facet>
						<p:commandButton type="push" title="Manage Unit Users"
							icon="ui-icon ui-icon-person"
							onclick='$("#unitUsersModalDialog").dialog("open");'
							actionListener="#{units.prepareManageUsers(unit)}"
							update=":unitUsers:unitUsersForm" />
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Add Sub Unit" />
						</f:facet>
						<p:commandButton type="push" title="Add Sub Unit"
							icon="ui-icon-document"
							actionListener="#{units.prepareAddSubUnit(unit)}"
							onclick='$("#newUnitModalDialog").dialog("open");'
							update=":newUnit:newUnitForm" />
					</p:column>



					<p:column>
						<f:facet name="header">
							<h:outputText value="Sub Units" />
						</f:facet>
						<p:commandButton type="push" title="Manage Sub Units"
							icon="ui-icon-newwin"
							actionListener="#{units.prepareManageSubUnits(unit)}"
							onclick='$("#unitSubUnitsModalDialog").dialog("open");'
							update=":unitSubUnits:unitSubUnitsForm" />
					</p:column>


					<ui:remove>
						<p:column>
							<f:facet name="header">
								<h:outputText value="Delete" />
							</f:facet>
							<p:commandButton type="push" title="Delete" icon="ui-icon-trash"
								update=":unitsForm" actionListener="#{units.delete(unit)}" />
						</p:column>
					</ui:remove>

				</p:dataTable>

			</h:form>

		</div>

	</ui:composition>
</body>
</html>