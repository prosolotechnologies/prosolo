<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
	
	<h:outputScript library="javascript" name="jquery.shortenedText.js" target="head"/>
	
	<div id="searchGeneral">
		<h2>General</h2>
		
		<h:form>
			<ui:repeat value="#{evaluations.evaluations}" var="ev">
				
				<h:link styleClass="box" outcome="/evaluation" includeViewParams="true">
	                <f:param  name="id" value="#{ev.evaluationSubmission.id}" />
	                
					<div class="avatar">
						<h:graphicImage styleClass="imageRound image30"
							value="#{ev.senderAvatar}"
							width="30" height="30" alt="" />
					</div>
					
					<div class="textWrapper">
						<div class="user">
							<span class="name">#{ev.name}</span>, evaluation for: 
							<span class="name resource">#{ev.goalName}</span>
						</div>
						<div class="clear"></div>
						<div class="message">"#{ev.message}"</div>
					</div>
					
					<div class="date">#{ev.date}</div>
					
					<h:panelGroup layout="block" class="badgeContainer">
						<ui:repeat value="#{ev.badges}" var="badge">
							<div class="badgeWrapper">
	    						<h:panelGroup layout="block" styleClass="badge size20 badge#{badge.capitalizedName}" />
			    			</div>
						</ui:repeat>
					</h:panelGroup>
	                
	            </h:link>
				
				<div class="separator clear"></div>
			
			</ui:repeat>
			
			<script type="text/javascript">
			$(function() {
				$('.box .name.resource').shortenedText({showChar: 40, mode: 'static'});
				$('.box .message').shortenedText({showChar: 160, mode: 'static'});
			});
			</script>
		</h:form>
	</div>
</ui:composition>