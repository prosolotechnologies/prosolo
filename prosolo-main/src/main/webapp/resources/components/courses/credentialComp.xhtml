<ui:component
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:post="http://java.sun.com/jsf/composite/components/post">

	<composite:interface>
		<composite:attribute name="credential" required="true" />
		<composite:attribute name="bean" required="true" />
		<composite:attribute name="learningContext" />
		<composite:attribute name="service" default=""/>
	</composite:interface>
	
	<composite:implementation>
		<div class="col-md-6">
            <article class="whiteBox summaryCard">
                <h2>
                	<h:link 
                		value="#{cc.attrs.credential.title}"
                		outcome="/credential">
                		<f:param name="id" value="#{util:encodeId(cc.attrs.credential.id)}"/>
                	</h:link>
                </h2>
                <div class="clear"></div>
                <p>#{cc.attrs.credential.description}</p>
                <div class="metaBox">
                    <div class="metaLeft">
                    	<ui:fragment rendered="#{cc.attrs.credential.enrolled}">
                    		<ui:fragment rendered="#{cc.attrs.credential.completed}">
                    			<div class="tagCompleted">Completed</div>
                    		</ui:fragment>
                    		<ui:fragment rendered="#{!cc.attrs.credential.completed}">
                    			<h:link
                    				value="Resume"
                    				styleClass="btn btn-green btn-sm"
                    				outcome="/credential">
                    				<f:param name="id" value="#{util:encodeId(cc.attrs.credential.id)}"/>
                    			</h:link>
	                            <div class="progressBar">
	                                <span>#{cc.attrs.credential.progress}%</span>
	                                <div class="progress">
	                                    <div class="progress-bar" role="progressbar" aria-valuenow="#{cc.attrs.credential.progress}" aria-valuemin="0" aria-valuemax="100" style="width: #{cc.attrs.credential.progress}%;">
	                                    </div>
	                                </div>
	                            </div>
                    		</ui:fragment>
                    	</ui:fragment>
                    	
                    	<ui:fragment rendered="#{!cc.attrs.credential.enrolled and !cc.attrs.credential.firstTimeDraft}">
                    		<p:commandLink
	                    		value="Start"
	                    		styleClass="btn btn-green btn-sm"
	                    		action="#{cc.attrs.bean.enrollInCredential(cc.attrs.credential)}">
	                    		<f:param name="page" value="#{facesContext.viewRoot.viewId}"/>
                            	<f:param name="learningContext" value="#{util:addSubContext(cc.attrs.learningContext, 'name:credential|id:'.concat(cc.attrs.credential.id))}"/>
	                    	</p:commandLink>
                    	</ui:fragment>
                    </div>
                    <div class="metaRight">
                    	<ui:fragment rendered="#{cc.attrs.credential.userCreated}">
                    		<a href="" class="madeByUser" data-toggle="tooltip"
    						title="Made by #{cc.attrs.credential.creator.name}">made by user</a>
                    	</ui:fragment>
						<ui:fragment rendered="#{cc.attrs.credential.universityCreated}">
                    		<a href="" class="madeByUniversity" data-toggle="tooltip"
            					title="Made by University">made by university</a>
                    	</ui:fragment>
                        <div class="duration">#{cc.attrs.credential.durationString}</div>
                    </div>
                </div>
                <p:commandLink
                	value="bookmark"
                	styleClass="bookmarkStar #{cc.attrs.credential.bookmarkedByCurrentUser ? 'active' : ''}"
                	pt:data-toggle="tooltip"
                	pt:title="Bookmark"
                	action="#{cc.attrs.bean.bookmarkCredential(cc.attrs.credential)}"
                	update="@this">
                	<f:param name="page" value="#{facesContext.viewRoot.viewId}"/>
                    <f:param name="learningContext" value="#{util:addSubContext(cc.attrs.learningContext, 'name:credential|id:'.concat(cc.attrs.credential.id))}"/>
                </p:commandLink>
            </article>
        </div>
	</composite:implementation>
</ui:component>