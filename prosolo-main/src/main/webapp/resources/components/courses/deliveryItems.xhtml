<ui:component
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:composite="http://java.sun.com/jsf/composite"
		xmlns:c="http://java.sun.com/jsp/jstl/core"
		xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
		xmlns:util="http://www.prosolo.com/util"
		xmlns:p="http://primefaces.org/ui"
		xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

	<composite:interface>
		<composite:attribute name="deliveries" required="true" />
		<composite:attribute name="showNumberOfStudentsAndInstructors" default="false" />
		<composite:attribute name="canEdit" default="false" />
		<composite:attribute name="isAdmin" type="java.lang.Boolean" default="false" />
		<composite:attribute name="bean" />
		<composite:attribute name="onDeliveryEditComplete" default=""/>
		<composite:attribute name="onDeliveryEditUpdate" default="" />
		<composite:attribute name="encodedOrgId" default="" />
		<composite:attribute name="encodedUnitId" default="" />
	</composite:interface>
	
	<composite:implementation>
		<utilcomp:messagesBundle var="msg" />
		<ul>
			<ui:repeat var="delivery" value="#{cc.attrs.deliveries}">
	            <li class="deliveryItem">
	                <div class="deliveryItemLeft">
	                    <div class="status #{styleUtilBean.getStyleClassBasedOnDeliveryStatus(delivery.deliveryStatus)}"></div>
	                    <h3><span>#{msg['label.delivery']} title:</span> #{delivery.title}</h3>
	                    <div class="deliveryMeta">
							<h:panelGroup layout="block" styleClass="deliveryStage" rendered="#{delivery.learningStageEnabled}">
								<div class="stage"><span>Stage:</span> #{delivery.learningStage.title}</div>
							</h:panelGroup>
	                        <div class="deliveryTime">
	                            <div class="start"><span>Start:</span>
									<utilcomp:convertTimeOutput
											millis="#{delivery.deliveryStartTime}"
											format="MMM DD, YYYY [at] hh:mm a"
									/>
								</div>
	                            <div class="end"><span>End:</span>
									<utilcomp:convertTimeOutput
											millis="#{delivery.deliveryEndTime}"
											format="MMM DD, YYYY [at] hh:mm a"
									/>
								</div>
	                        </div>
	                        <c:if test="#{cc.attrs.showNumberOfStudentsAndInstructors}">
		                        <div class="deliveryPeople">
		                            <div class="students">
		                            	<span>Students:</span> 
		                            	<ui:fragment rendered="#{delivery.numberOfStudents gt 0}">
		                            		<a href="javascript:void(0);">#{delivery.numberOfStudents}</a>
		                            	</ui:fragment>
		                            	<ui:fragment rendered="#{delivery.numberOfStudents le 0}">
		                            		-
		                            	</ui:fragment>		
		                            </div>
		                            <div class="instructors"><span>Instructors:</span> 
		                            	<ui:fragment rendered="#{delivery.numberOfInstructors gt 0}">
		                            		<a href="javascript:void(0);">#{delivery.numberOfInstructors}</a>
		                            	</ui:fragment>
		                            	<ui:fragment rendered="#{delivery.numberOfInstructors le 0}">
		                            		-
		                            	</ui:fragment>	
		                            </div>
		                        </div>
		                    </c:if>
	                    </div>
	                </div>
	                <div class="deliveryItemRight">
						<ui:fragment rendered="#{not delivery.archived}">
							<div class="dropdown optMoreMenu">
								<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">options menu</a>
								<ul class="dropdown-menu bullet pull-center" aria-labelledby="dropdownMenu2">
									<li>
										<p:commandLink
													   value="Archive"
													   styleClass="linkRed"
													   process="@this"
													   action="#{cc.attrs.bean(delivery)}"
													   update=":archiveDialog"
													   oncomplete="$('#archiveModal').modal('show');">
										</p:commandLink>
									</li>
								</ul>
							</div>
						</ui:fragment>
						<ui:fragment rendered="#{delivery.archived}">
							<div class="dropdown optMoreMenu">
								<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">options menu</a>
								<ul class="dropdown-menu bullet pull-center" aria-labelledby="dropdownMenu2">
									<li>
										<p:commandLink
												value="Restore"
												styleClass="linkRed"
												process="@this"
												action="#{cc.attrs.bean.select(delivery)}"
												update=":restoreDialog"
												oncomplete="$('#restoreModal').modal('show');">
										</p:commandLink>
									</li>
								</ul>
							</div>
						</ui:fragment>
	                    <h:link rendered="#{not cc.attrs.isAdmin and cc.attrs.canEdit}"
	                    	outcome="/manage/create-credential" 
	                    	styleClass="btn btn-green-stroke btn-sm">
	                    	Edit
	                    	<f:param name="id" value="#{util:encodeId(delivery.id)}"></f:param>
	                    </h:link>
						<p:commandLink rendered="#{cc.attrs.isAdmin}"
									   styleClass="btn btn-green-stroke btn-sm"
									   pt:data-toggle="modal"
									   process="@this"
									   action="#{cc.attrs.bean.select(delivery)}"
									   oncomplete="#{cc.attrs.onDeliveryEditComplete}"
									   update="#{cc.attrs.onDeliveryEditUpdate}">
							Edit Start/End
						</p:commandLink>
						<h:link rendered="#{cc.attrs.isAdmin}" outcome="/admin/credential">
							View
							<f:param name="orgId" value="#{cc.attrs.encodedOrgId}"></f:param>
							<f:param name="unitId" value="#{cc.attrs.encodedUnitId}"></f:param>
							<f:param name="id" value="#{util:encodeId(delivery.id)}"></f:param>
						</h:link>
	                    <h:link rendered="#{not cc.attrs.isAdmin}" outcome="/manage/credential">
							Preview
	                    	<f:param name="id" value="#{util:encodeId(delivery.id)}"></f:param>
	                    </h:link>
	                </div>
	            </li>
	         </ui:repeat>
        </ul>
	</composite:implementation>
</ui:component>