<ui:component
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:post="http://java.sun.com/jsf/composite/components/post"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

	<composite:interface>
        <composite:attribute name="chooseOptionText" required="true" />
		<composite:attribute name="chooseOptionValue" required="true" />
		<composite:attribute name="selectBooleanOnChangeEvent" default="" />
		<composite:attribute name="publishValues" required="true" />
		<composite:attribute name="publishValue" required="true" />
		<composite:attribute name="saveAction" required="true" method-signature="void save()"/>
		<composite:attribute name="toUpdate" required="true" />
		<composite:attribute name="previewAction" required="true" method-signature="void preview()"/>
		<composite:attribute name="linkPreviewClass" required="true" />
	</composite:interface>
	
	<composite:implementation>
		<div id="#{cc.clientId}" class="whiteBox publishBox">
			<h2>Publish</h2>
			
			<p:commandLink
				value="Preview"
				styleClass="linkPreview"
				action="#{cc.attrs.previewAction}"
				update="#{cc.attrs.toUpdate}"
				oncomplete="if(args &amp;&amp; !args.validationFailed) {attachListenersForUpdatingStatus(); document.getElementsByClassName('#{cc.attrs.linkPreviewClass}')[0].click();}"/>
			
			<div class="clear"></div>
			
			<div class="checkbox checkLine">
			
				<h:selectBooleanCheckbox 
					id="checkMandatory"
					onclick="console.log(this.checked)"
					value="#{cc.attrs.chooseOptionValue}"
					onchange="updateStatusToDraft(); #{cc.attrs.selectBooleanOnChangeEvent}();">
				</h:selectBooleanCheckbox>
				
				<label for="#{cc.clientId}:checkMandatory">
					#{cc.attrs.chooseOptionText}
				</label>
			</div>
			
			<h:selectOneMenu 
				id="selectStatus" styleClass="selectpicker" 
				value="#{cc.attrs.publishValue}">
				<f:selectItems value="#{cc.attrs.publishValues}" var="status"
					itemValue="#{status}" itemLabel="#{status.label}" />
			</h:selectOneMenu>
			
			<script>$('.selectpicker').selectpicker('refresh');</script>
			
			<div class="publishRow">
				<p:commandLink 
					styleClass="btn btn-green" 
					action="#{cc.attrs.saveAction}"
					update="#{cc.attrs.toUpdate}"
					oncomplete="attachListenersForUpdatingStatus();">
					Save changes
				</p:commandLink>
				<a href="#" class="linkRed" data-toggle="modal" data-target="#deleteModal">Delete</a>      
			</div>
		</div>
	</composite:implementation>
</ui:component>