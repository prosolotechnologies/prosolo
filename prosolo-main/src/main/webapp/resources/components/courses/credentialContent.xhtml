<ui:component xmlns:h="http://java.sun.com/jsf/html"
			  xmlns:f="http://java.sun.com/jsf/core"
			  xmlns:ui="http://java.sun.com/jsf/facelets"
			  xmlns:composite="http://java.sun.com/jsf/composite"
			  xmlns:p="http://primefaces.org/ui"
			  xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
			  xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
			  xmlns:courses="http://java.sun.com/jsf/composite/components/courses">

	<composite:interface>
		<composite:attribute name="bean" required="true" />
		<composite:attribute name="role" type="java.lang.String" default="USER" />
		<composite:attribute name="learningContext" default="" />
		<composite:attribute name="growlToUpdate" default="" />
		<composite:attribute name="startedLearning" required="true" />
		<composite:attribute name="readOnly" required="true" />
	</composite:interface>

	<composite:implementation>
		<script>
			function markAnnouncementReadWithId(announcementId) {
				markAnnouncementRead([ {
					name : 'announcementId',
					value : announcementId
				} ])
			}
		</script>

		<div class="container">
			<div class="row">
				<div
					class="col-md-8 #{cc.attrs.bean.credentialData.mandatoryFlow ? 'mandatoryFlow' : ''}">
					<h:panelGroup
						rendered="#{cc.attrs.startedLearning and announcementStudentBean.userDidNotReadLastAnnouncement(cc.attrs.bean.id)}"
						layout="block" styleClass="alert alert-info alert-dismissible"
						pt:role="alert">
						<p:remoteCommand name="markAnnouncementRead" update="@none"
							process="@this"
							actionListener="#{announcementStudentBean.markAnnouncementReadFromAjax()}"></p:remoteCommand>
						<button
							onclick="markAnnouncementReadWithId('#{announcementStudentBean.announcementId}')"
							type="button" class="close" data-dismiss="alert"
							aria-label="Close">
							<span aria-hidden="true">Ã—</span>
						</button>
						There's a new announcements for this #{msg['label.credential']}.
						<h:link outcome="announcement">
							Read here
							<f:param name="id" value="#{param['id']}"></f:param>
							<f:param name="announcementId"
								value="#{announcementStudentBean.announcementId}"></f:param>
						</h:link>.
					</h:panelGroup>
					<h2>About #{msg['label.credential']}</h2>
					<p>
						<h:outputText escape="false"
							value="#{cc.attrs.bean.credentialData.description}" />
					</p>
					<courses:compList bean="#{cc.attrs.bean}"
						competences="#{cc.attrs.bean.credentialData.competences}"
						credentialId="#{param['id']}" isEdit="false"
						startedLearning="#{cc.attrs.startedLearning}"
						readOnly="#{cc.attrs.readOnly}"
						learningContext="#{cc.attrs.learningContext}"
						growlToUpdate="#{cc.attrs.growlToUpdate}"
						role="#{cc.attrs.role}"/>
				</div>

				<div class="col-md-4">
					<h:panelGroup layout="block" styleClass="sidebarBlock"
						rendered="#{cc.attrs.role eq 'USER' and cc.attrs.startedLearning}">
						There

						#{cc.attrs.bean.numberOfUsersLearningCred == 1 ? 'is' : 'are'}
						<h:link outcome="/credential-students">
							<f:param name="id" value="#{param['id']}" />
							#{cc.attrs.bean.numberOfUsersLearningCred} student#{cc.attrs.bean.numberOfUsersLearningCred == 1 ? '' : 's'}
						</h:link>
						who #{cc.attrs.bean.numberOfUsersLearningCred == 1 ? 'is' : 'are'} learning this #{msg['label.credential'].toLowerCase()}.
					</h:panelGroup>
					<ui:fragment rendered="#{not empty cc.attrs.bean.credentialData.tags}">
						<div class="sidebarBlock #{cc.attrs.role eq 'USER' ? 'sidebarBlockKeywords' : ''}">
								<h2>Keywords</h2>
								<ul class="tags">
									<ui:repeat var="tag"
										value="#{cc.attrs.bean.credentialData.tags}">
										<li>#{tag.title}</li>
									</ui:repeat>
								</ul>
							<ui:fragment
								rendered="#{cc.attrs.role eq 'USER' and cc.attrs.startedLearning and cc.attrs.bean.numberOfTags gt 0}">
								<p class="keywordsExplore">
									There #{cc.attrs.bean.numberOfTags gt 1 ? 'are' : 'is'} #{cc.attrs.bean.numberOfTags} keyword#{cc.attrs.bean.numberOfTags gt 1 ? 's' : ''} more that
									describe #{msg['label.competence.plural'].toLowerCase()} and activities of this #{msg['label.credential'].toLowerCase()}.
									<h:link value="Click here to filter them."
										outcome="credential-keywords">
										<f:param name="id" value="#{cc.attrs.bean.id}" />
									</h:link>
								</p>
							</ui:fragment>
						</div>
					</ui:fragment>

					<ui:fragment
						rendered="#{not empty cc.attrs.bean.credentialData.hashtags}">
						<div class="sidebarBlock">
							<h2>Twitter hashtags</h2>
							<ul class="tags">
								<ui:repeat var="hashtag"
									value="#{cc.attrs.bean.credentialData.hashtags}">
									<li>#{hashtag.title}</li>
								</ui:repeat>
							</ul>
						</div>
					</ui:fragment>

					<ui:fragment
						rendered="#{not empty cc.attrs.bean.credentialData.instructorFullName}">
						<div class="sidebarBlock">
							<h2>Your instructor</h2>
							<div class="user32">
								<a href="#"> <utilcomp:userAvatar
										avatar="#{cc.attrs.bean.credentialData.instructorAvatarUrl}"
										fullName="#{cc.attrs.bean.credentialData.instructorFullName}" />
								</a>
								<h3>
									<a href="#">#{cc.attrs.bean.credentialData.instructorFullName}</a>
								</h3>
							</div>
						</div>
					</ui:fragment>

					<div class="sidebarBlock">
						<h2>Created by</h2>
						<div class="user32">
							<a href="#"> <utilcomp:userAvatar
									avatar="#{cc.attrs.bean.credentialData.creator.avatar}"
									fullName="#{cc.attrs.bean.credentialData.creator.name}" />
							</a>
							<h3>
								<a href="#">#{cc.attrs.bean.credentialData.creator.name}</a>
							</h3>
						</div>
					</div>
				</div>
			</div>
		</div>
	</composite:implementation>
</ui:component>