<ui:component
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:post="http://java.sun.com/jsf/composite/components/post">

	<composite:interface>
		<composite:attribute name="activity" required="true" />
		<composite:attribute name="bean" required="true" />
	</composite:interface>
	
	<composite:implementation>
		<div id="#{cc.clientId}">
		<!-- video activity start -->
	    <h:panelGroup layout="block" rendered="#{cc.attrs.activity.activityType == 'VIDEO'}" styleClass="fieldsVideo">
           <div class="formLine">
               <label>Video URL</label>
               <div class="formLineRight">
               	   <h:inputText value="#{cc.attrs.activity.link}"/>
               </div>
           </div>
        </h:panelGroup>
        
        <!-- text activity start -->
        <h:panelGroup layout="block" rendered="#{cc.attrs.activity.activityType == 'TEXT'}" styleClass="fieldsText">
          <div class="formLine">
              <label>Text</label>
              <div class="formLineRight">
              	  <h:inputTextarea 
              	  	value="#{cc.attrs.activity.text}"
              	  	styleClass="textareaBig"/>
              </div>
          </div>
     	</h:panelGroup>
     	
     	 <h:panelGroup layout="block" rendered="#{cc.attrs.activity.activityType == 'SLIDESHARE'}" styleClass="fieldsSlideshare">
	          <div class="formLine">
	              <label>Slideshare URL</label>
	              <div class="formLineRight">
	                   <h:inputText value="#{cc.attrs.activity.link}"/>
	              </div>
	          </div>
	     </h:panelGroup>
	       
	     <h:panelGroup rendered="#{cc.attrs.activity.activityType != 'EXTERNAL_TOOL'}">
	         <div class="formLine">
	             <label>Upload file</label>
	             <div class="formLineRight">
	             	<h:panelGroup id="panelFiles">
	                 <ul class="addedItems">
	                 	<ui:repeat var="file" value="#{cc.attrs.activity.files}">
	                 		<ui:fragment rendered="#{file.status != 'REMOVED'}">
	                 			<li>
			                         <a href="#{file.url}" target="_blank">#{file.linkName}</a>
			                         <p:commandLink 
			                         	styleClass="removeX" 
			                         	pt:data-toggle="tooltip" 
			                         	pt:title="Remove"
			                         	process="@this"
			                         	action="#{cc.attrs.bean.removeFile(file)}"
			                         	update=":#{cc.clientId}:panelFiles">
			                         	remove
			                         </p:commandLink>
	                     		</li>
	                 		</ui:fragment>
	                 	</ui:repeat>
	                 </ul>
	                 <p:fileUpload id="fileUploadActivityFile" 
	                 		process="@this"
               				style="display: none;"
               				styleClass="fileUploadActivityFile"
							fileUploadListener="#{activityEditBean.handleFileUpload}"  
				            dragDropSupport="true"
				            fileLimit="1"
				        	auto="true"
				            label="Choose a file"
				            update=":#{cc.clientId}:panelFiles"
				            onstart="showLoader('#loaderContainerFileUpload');"
				            oncomplete="hideLoader('#loaderContainerFileUpload');"
		             />
	                 <a href="javascript:void(0);" id="linkTriggerFileUpload" class="btn btn-green">Choose File</a>
	                 <div id="loaderContainerFileUpload"/>
	                 <script>
	                 	$('#linkTriggerFileUpload').on('click', function(e){
					 		e.stopPropagation();
							$('.fileUploadActivityFile :input').trigger('click');
						});
	                 </script>
	                 </h:panelGroup>
	             </div>
	         </div>
	         <div class="formLine">
	             <label>Add URL</label>
	             <div class="formLineRight">
	             	<h:panelGroup id="panelLinks">
	                 <ul class="addedItems">
	                 	<ui:repeat var="link" value="#{cc.attrs.activity.links}">
	                 		<ui:fragment rendered="#{link.status != 'REMOVED'}">
		                 		<li>
			                         <a href="#{link.url}" target="_blank">#{link.url}</a>
			                         <p:commandLink 
			                         	styleClass="removeX" 
			                         	pt:data-toggle="tooltip" 
			                         	pt:title="Remove"
			                         	process="@this"
			                         	action="#{cc.attrs.bean.removeLink(link)}"
			                         	update=":#{cc.clientId}:panelLinks">
			                         	remove
			                         </p:commandLink>
		                     	</li>
		                     </ui:fragment>
	                 	</ui:repeat>
	                 </ul>
	                 </h:panelGroup>
	                 
	                 <p:remoteCommand
	                 	name="addLinkRC"
	                 	process="inputLink"
	                 	action="#{cc.attrs.bean.addLink()}"
	                 	update=":#{cc.clientId}:panelLinks :#{cc.clientId}:inputLink">
	                 </p:remoteCommand>
	                 <h:inputText 
	                 	id="inputLink"
	                 	placeholder="Type URL and press 'Enter'"
	                 	value="#{cc.attrs.bean.linkToAdd}"
	                 	onkeypress="addLinkOnEnter();"/>
	                 	
	                 
	             </div>
	             <script>
	             	function addLinkOnEnter() {
	             		if (event.keyCode == 13) {
	             			addLinkRC();
	             		}
	             	}
	             </script>
	         </div>
	         <div class="formLine">
	             <label>Upload result</label>
	             <div class="formLineRight">
	                 <div class="checkbox checkLine">
	                 	 <h:selectBooleanCheckbox id="checkUploadResult"
                    		value="#{cc.attrs.activity.uploadAssignment}">
                    	 </h:selectBooleanCheckbox>
	                     <label for="#{cc.clientId}:checkUploadResult">Show "Upload Result" option</label>
	                 </div>
	             </div>
	         </div>
         </h:panelGroup>
         
         <!-- external tool activity -->
   		 <h:panelGroup layout="block" rendered="#{cc.attrs.activity.activityType == 'EXTERNAL_TOOL'}" styleClass="fieldsExternal">
            <div class="formLine">
                <label>&#160;</label>
                <div class="formLineRight">
                    <p>External activities are added via LTI protocol. Please provide LTI tool details obtained from your LTI provider.</p>
                </div>
            </div>
            <div class="formLine">
                <label>Launch URL</label>
                <div class="formLineRight">
                     <h:inputText value="#{cc.attrs.activity.launchUrl}"/>
                </div>
            </div>
            <div class="formLine">
                <label>Shared secred</label>
                <div class="formLineRight">
                     <h:inputText value="#{cc.attrs.activity.sharedSecret}"/>
                </div>
            </div>
            <div class="formLine">
                <label>Consumer key (optional)</label>
                <div class="formLineRight">
                     <h:inputText value="#{cc.attrs.activity.consumerKey}"/>
                </div>
            </div>
            <div class="formLine">
                <label>&#160;</label>
                <div class="formLineRight">
                    <div class="checkbox checkLine">
                    	<h:selectBooleanCheckbox id="checkAcceptGrades"
                    		value="#{cc.attrs.activity.acceptGrades}">
                    	</h:selectBooleanCheckbox>
                        <label for="#{cc.clientId}:checkAcceptGrades">Accept grades</label>
                    </div>
                </div>
            </div>
        </h:panelGroup>
    	</div>
	</composite:implementation>
</ui:component>