<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks">
	
	<div id="peopleListDialog" title="People List" class="peopleListDialog" style="display: none;">
		<h:form id="peopleListForm" prependId="false" class="peopleList">	

			<div class="peopleContainer">
				<ui:repeat value="#{peopleListDialog.people}" var="peopleIterator" varStatus="peopleIteratorStatus">
					<div class="user">
						<div class="imageContainer">
							<link:user
								userData="#{peopleIterator}" 
								mode="image"
								imageSize="48"
								idPrefix="peopleListAvatar#{peopleIteratorStatus.index}"
								context="peopleListDialog.image"
							/>
						</div>
						
						<div class="info">
							<div class="name">
								<h:link value="#{peopleIterator.name}" outcome="/publicprofile">
									<f:param name="user" value="#{peopleIterator.id}" />
								</h:link>
							</div>
							<div class="position">#{peopleIterator.position}</div>
						</div>
						
						<div class="followButton">
							<p:commandLink value="Follow"
								styleClass="button green size30 right"
								rendered="#{!peopleIterator.loggedUser and !peopleIterator.followed}"
							 	action="#{peopleListDialog.followCollegue(peopleIterator)}"
							 	update=":peopleListForm"/>
							 	
							<p:commandLink value="Unfollow"
								styleClass="button gray size30 right"
								rendered="#{!peopleIterator.loggedUser and peopleIterator.followed}"
							 	action="#{peopleListDialog.unfollowCollegue(peopleIterator)}"
							 	update=":peopleListForm"/>
						</div>
					</div>
					
					<h:panelGroup layout="block" class="clear separator" rendered="#{peopleIteratorStatus.index != (peopleListDialog.people.size() -1)}"/>
				</ui:repeat>
			</div>
			
			<p:growl id="peopleListDialogGrowl" showDetail="true" />
			
			<script>
				$(function() {
					roundImages();
				});
			</script>
		</h:form>
	</div>
	<script>
		$(function() {
			$('#peopleListDialog').dialog({
				autoOpen : false,
				show : 'slide',
				modal : true,
				width : 500,
				resizable : false,
				open : function(event, ui) {
					$(this).children(':first')
						.css('text-align', 'center')
						.css('padding-top', '50px')
						.html('<img src="#{request.contextPath}/resources/images/style/ajax-loader-black.gif" style="vertical-align:middle;"/>');
				}
			});
			$('#peopleListDialog').show();
		});
	</script>
</ui:composition>