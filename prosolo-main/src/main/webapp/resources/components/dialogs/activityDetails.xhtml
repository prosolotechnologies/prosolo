<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:action="http://java.sun.com/jsf/composite/components/actions"
	xmlns:socialWall="http://java.sun.com/jsf/composite/components/socialWall">
	
	<div id="activityDetailsModalDialog" class="activityDetails" title="Activity Details" style="display: none">
		<h:form id="activityDetailsForm" prependId="false">
			<p:growl id="activityDetailsGrowl" showDetail="true" />
			
			<div class="actBlock">
				<p class="title">
					#{activityDetailsBean.activityData.object.title}
				</p>
				
				<socialWall:attachmentPreview
					uniqueParentSelector="#activityDetailsModalDialog"
					attachmentPreview="#{activityDetailsBean.activityData.attachmentPreview}" />
			</div>
					
			<span class="marginRight10">Created by:</span> 
			
			<link:user value="activityDetailsMakerImage" 
   				user="#{activityDetailsBean.maker}"
   				mode="imageName"
   				imageSize="22"
   				idPrefix="activityDetailsMaker"
   				context="activityDetails.imageName"/>

			<div class="clear marginBottom10"></div>
			
			<c:if test="#{loggeduser != null and loggeduser.loggedIn}">
				<action:addToCompetence
					styleClass="green right"
					buttonSize="30"
					activity="#{activityDetailsBean.activity}"
					onclick="$('#activityDetailsModalDialog').dialog('close');"
					targetCompIdToPreselect="#{activityDetailsBean.targetCompIdToPreselectWhenAdding}"
					toUpdateAfterAdding="#{activityDetailsBean.toUpdateAfterAddingToCompetence}" />
			</c:if>


			<script>
			$(function() {
				roundImages();
				$('.activityDetails .actBlock .richContent .atcUrl').shortenedText({showChar: 35, mode: 'static'});
			});
			</script>
		</h:form>
	</div>
	<script>
	$(function() {
		$('#activityDetailsModalDialog').dialog({
			autoOpen: false,
			show : 'slide',
			width: 450,
			modal: true,
			resizable: false,
			open: function(event, ui) { 
				$(this).children(':first')
					.css('text-align', 'center')
					.css('padding-top', '50px')
					.html('<img src="#{request.contextPath}/resources/images/style/ajax-loader-black.gif" style="vertical-align:middle;"/>');
			},
		});
		$('#activityDetailsModalDialog').show();
	});
	</script>
</ui:composition>