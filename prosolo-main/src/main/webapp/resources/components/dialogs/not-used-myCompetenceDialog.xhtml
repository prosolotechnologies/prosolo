   <ui:composition
   	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:comp="http://java.sun.com/jsf/composite/components">
	
	<h:outputScript library="javascript" name="jquery.shortenedText.js" target="head"/>
	
    <h:form id="compDetailsFormDialog">
    	<p:growl id="compDetailsFormDialogGrowl" showDetail="true" />
    	
	    <div id="myCompetenceDetailsFormModalDialog" title="Competence details"  style="display: none;">
			
			 <h:panelGroup layout="block" id="compDetailsForm" class="compDetails">
				<script>
				$(function() {
					roundImages();
					 $('.expandableText').shortenedText({showChar: 150});
				});
				</script>
				<table id="compDetailsTable">
					<tr>
						<td class="col1">
							<label for="compName">Name:</label>
						</td>
						<td>
							<h:outputText id="compName"
								value="#{compdialog.formData.title}" />
						</td>
						<td class="col3">
							<p:commandLink styleClass="button gray size20 btnSave" id="btnEditComp" value="Edit"
								onclick="toggleEditMode('#compDetailsTable','#compEditTable');" />
						</td>
					</tr>
					<tr>
						<td class="col1">
							<label for="compDescription">Description:</label>
						</td>
						<td colspan="2">
							<h:outputText id="compDescription"
								class="expandableText"
								value="#{compdialog.formData.description}" />
						</td>
					</tr>
					<tr>
						<td class="col1">
							<label for="validityPeriod">Validity:</label>
						</td>
						<td colspan="2">
							<h:outputText id="validityPeriod"
								value="#{compdialog.formData.validity}" />&#160; month(s)
						</td>
					</tr>
				</table>
				<table class="editCompetence hidden" id="compEditTable">
					<tr>
						<td class="col1">
							<label for="compNameEdit">Name:</label>
						</td>
						<td>
							<h:inputText id="compNameEdit"
								value="#{compdialog.formData.title}" />
						</td>
						<td>
							<p:commandLink styleClass="button gray size20 btnSave" id="btnSaveComp" value="Save"
								onclick="toggleEditMode('#compDetailsTable','#compEditTable');"
								actionListener="#{compdialog.saveCompetenceEdit}" 
								update=":compDetailsFormDialog" />
						</td>
					</tr>
					<tr class="description">
						<td class="col1 label">
							<label for="compDescriptionEdit">Description:</label>
						</td>
						<td colspan="2">
							<h:inputTextarea id="compDescriptionEdit"
								value="#{compdialog.formData.description}" />
						</td>
					</tr>
					<tr class="validity">
						<td class="col1">
							<label for="validityPeriodEdit">Validity:</label>
						</td>
						<td colspan="2">
							<h:inputText id="validityPeriodEdit"
								value="#{compdialog.formData.validity}" />&#160; month(s)
						</td>
					</tr>
				</table>
				<table>
					<tr>
						<td class="col1">
							<label for="createdby">Created by:</label>
						</td>
						<td>
							<a href="#">
							<h:graphicImage styleClass="imageRound image22"
									value="#{colleguesBean.avatarUrl(loggeduser.user,22)}" width="22"
									height="22" alt="" /></a>
							<a href="#"><h:outputText id="createdby"
								value="#{compdialog.formData.maker.name} #{compdialog.formData.maker.lastname}" /></a>
							
						</td>
					</tr>
					<tr>
						<td class="plans" colspan="2">
							<div class="plansWrapper">
								Activity plans recommended:
								<comp:planrecommend 
									value="planrecommend"
									parentid="myCompetenceDetailsFormModalDialog"
									connect="false"
									recommendedplans="#{compdialog.recommendedPlans}"
									selectedtargetcompetence="#{compdialog.selectedTargetComp}"
									cantdisplaymessage="There are no available plans because no competences has been associated with this goal." 
									context="dialog">
								</comp:planrecommend>
							</div>
							<div class="analyticsWrapper">
								Analytics 
								<c:set var="competenceData" value="#{competenceDialog.getCompetenceAnalyticsData(compdialog.selectedTargetComp)}"/>
								<comp:competenceanalytics competencedata="#{competenceData}" parentId="competenceDialog"/>
							</div>
						</td>
					</tr>
				</table>
				
			</h:panelGroup>
		</div>
	</h:form>
	<script>
	$(function() {
		$( '#myCompetenceDetailsFormModalDialog' ).dialog({
			autoOpen: false,
			show: 'slide',
			width: 600,
			modal: true,
			resizable: false,
			open: function(event, ui) { 
				 $(this).children(':first')
				 	.css('text-align','center')
			 		.css('padding-top','200px')
			 		.html('<img src="#{request.contextPath}/resources/images/style/ajax-loader-black.gif" style="vertical-align:middle;"/>');
			}
		});
		$( '#myCompetenceDetailsFormModalDialog' ).show();
	});
	</script>
</ui:composition>