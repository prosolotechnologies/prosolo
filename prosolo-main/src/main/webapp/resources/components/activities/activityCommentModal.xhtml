<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	template="templates/masterLayout2.xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:activities="http://java.sun.com/jsf/composite/components/activities"
	xmlns:post="http://java.sun.com/jsf/composite/components/post"
	xmlns:composite="http://java.sun.com/jsf/composite">

	<composite:interface>

	</composite:interface>


	<composite:implementation>
		<h:outputStylesheet library="css2" name="bootstrap-slider.css" />
		<script
			src="#{request.contextPath}/resources/javascript2/bootstrap-slider.min.js"></script>

		<script>

			//comment form hide/show
			function displaySubmitButtonPrivateConvModal(inputElem) {
				if ($(inputElem).val().length == 0) {
					$(inputElem).next('a.btn-green').addClass('hidden');
				} else {
					$(inputElem).next('a.btn-green').removeClass('hidden');
				}
			}
		</script>

		<h:form id="formPrivateConversation">
			<div class="modal fade assessmentCommentsModal"
				id="assessmentCommentsModal1" tabindex="-1" role="dialog"
				aria-labelledby="assessmentCommentsModal">
				<div class="modal-dialog modal-lg">
					<h:panelGroup id="panelModalPrivateConversation" layout="block"
						styleClass="modal-content">
						<ui:fragment rendered="#{not empty activityPrivateConversationBean.activityAssessmentData}">
							<div class="modal-header alignLeft">
								<button type="button" class="close" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true">&#215;</span>
								</button>
								<h2 class="modal-title">Comments</h2>
							</div>
							<div class="discussion">
								<div class="comments">
									<ui:fragment
										rendered="#{not empty activityPrivateConversationBean.activityAssessmentData.activityDiscussionMessageData}">
										<ul class="media-list">
											<ui:repeat var="activityMessageData"
												value="#{activityPrivateConversationBean.activityAssessmentData.activityDiscussionMessageData}">
												<li class="media">
													<div class="media-left">
														<utilcomp:userAvatar
															avatar="#{activityMessageData.senderAvatarUrl}"
															fullName="#{activityMessageData.senderFullName}" />
													</div>

													<div class="media-body">
														<ui:fragment
															rendered="#{activityPrivateConversationBean.isCurrentUserMessageSender(activityMessageData)}">
															<div class="commentMain">
																<span class="commentTime"> Edited:
																	#{activityMessageData.dateUpdatedFormat} </span>

																<h3 class="media-heading">
																	#{activityMessageData.senderFullName}
																	<ui:fragment
																		rendered="#{activityMessageData.senderInsructor}">
																		<span>INSTRUCTOR</span>
																	</ui:fragment>
																</h3>

																<p class="commentText">#{activityMessageData.content}</p>
																<div class="editComment hidden">
																	<p:inputTextarea name="name"
																		styleClass="contentEditableComment"
																		style="width:100%;" rows="1"
																		value="#{activityMessageData.content}"></p:inputTextarea>
																	<p:commandLink styleClass="btn btn-sm btn-green"
																		oncomplete="hideEditPrivateConversationComment(this);"
																		update=":#{cc.clientId}:formPrivateConversation:panelModalPrivateConversation"
																		actionListener="#{activityPrivateConversationBean.editComment(activityMessageData.content, activityMessageData.encodedMessageId)}"
																		type="button" name="button">
																Submit
															</p:commandLink>

																	<a href="javascript:void(0)"
																		class="btn btn-sm btn-green-stroke"
																		onclick="hideEditPrivateConversationComment(this)">Cancel</a>
																</div>

																<div class="commentOptions">
																	<a href="javascript:void(0)" class="edit"
																		onclick="showEditComment(this)"> <span
																		class="icon"></span>Edit
																	</a>
																</div>
															</div>
														</ui:fragment>

														<ui:fragment
															rendered="#{not activityPrivateConversationBean.isCurrentUserMessageSender(activityMessageData)}">
															<div class="commentMain">
																<span class="commentTime"> Edited:
																	#{activityMessageData.dateCreatedFormat} </span>
																<h3 class="media-heading">
																	#{activityMessageData.senderFullName}
																	<ui:fragment
																		rendered="#{activityMessageData.senderInsructor}">
																		<span>INSTRUCTOR</span>
																	</ui:fragment>
																</h3>
																<p>#{activityMessageData.content}</p>
															</div>

															<div class="media replyInput hidden">
																<div class="media-left">
																	<utilcomp:userAvatar
																		avatar="#{activityMessageData.senderAvatarUrl}"
																		fullName="#{activityMessageData.senderFullName}" />
																</div>

																<div class="media-body replyComment">
																	<div class="commentForm">
																		<textarea placeholder="Add Comment..."
																			onkeyup="displaySubmitButtonPrivateConvModal(this)"></textarea>
																		<button type="button"
																			class="btn btn-sm btn-green hidden" name="button">
																			Submit</button>
																	</div>
																</div>
															</div>
														</ui:fragment>
													</div>
												</li>
											</ui:repeat>
										</ul>
									</ui:fragment>
								</div>
								<div class="addComment">
									<utilcomp:userAvatar avatar="#{loggeduser.avatar}"
										fullName="#{loggeduser.fullName}" />

									<div class="commentForm">
										<p:inputTextarea styleClass="contentEditableComment"
											style="width:100%;" rows="1"
											value="#{activityPrivateConversationBean.newCommentValue}"
											placeholder="Add Comment..."
											onkeyup="displaySubmitButtonPrivateConvModal(this)" />

										<p:commandLink
											action="#{activityPrivateConversationBean.addCommentToActivityDiscussion()}"
											type="button" styleClass="btn btn-sm btn-green hidden"
											name="button"
											update=":#{cc.clientId}:formPrivateConversation:panelModalPrivateConversation @(.privateConvMsgsNoLink_#{activityPrivateConversationBean.activityAssessmentData.targetActivityId})">
									Submit
									<f:param name="page" value="#{facesContext.viewRoot.viewId}" />
											<f:param name="learningContext" value="#{learningContext}" />
											<f:param name="service"
												value="name:result_private_conversation_dialog|id:#{activityPrivateConversationBean.activityAssessmentData.targetActivityId}" />
										</p:commandLink>

									</div>
								</div>
								<div class="clear"></div>
							</div>
						</ui:fragment>
					</h:panelGroup>
				</div>
			</div>
		</h:form>
	</composite:implementation>

</ui:component>