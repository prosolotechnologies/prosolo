<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:composite="http://java.sun.com/jsf/composite">
<h:head>
</h:head>

<composite:interface>
</composite:interface>

<composite:implementation xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util">

	<h:outputScript library="javascript" name="jquery.autosize.min.js" target="head" />
	
	<utilcomp:messagesBundle var="msg" />

	<div id="newRoleModalDialog" class="admin roleDetails roleDialog" title="#{msg['admin.roles.dialog.new.title']}" style="display: none;">
						
		<h:form id="newRoleForm" prependId="false">
			<p:growl id="newRoleFormGrowl" showDetail="true" />
			
			<table>
				<tr>
					<td class="col1">
						<h:outputLabel for="name">Name:</h:outputLabel>
					</td>
					<td>
						<h:inputText id="name" 
							value="#{roles.formData.name}" 
							required="true" 
							requiredMessage="Name is required"
							validator="#{roles.validateName}" />
					</td>
				</tr>
				<tr>
					<td class="col1 colDescription">
						<h:outputLabel for="description">Description:</h:outputLabel>
					</td>
					<td>
						<h:inputTextarea id="description" 
							value="#{roles.formData.description}"
							placeholder="#{msg['textarea.description']}" />
							
						<script>
						$(function() {
							$('.admin.roleDetails.newRole textarea').autosize();
						});
						</script>
					</td>
				</tr>
			</table>
			<h:panelGroup>
			<h:outputLabel class = "bold">Capabilities:</h:outputLabel>
			<p:selectManyCheckbox
				value="#{roles.selectedCapabilities}" layout="grid" columns="2">
				<f:selectItems value="#{roles.allCapabilities}" />
			</p:selectManyCheckbox>
			</h:panelGroup>
			
			<div class="actions">
				<p:commandLink id="save" value="Save" 
					styleClass="button green size30 right"
					oncomplete="
						if (args &amp;&amp; !args.validationFailed)
							$('#newRoleModalDialog').dialog('close');"
				 	action="#{roles.saveNewRole}" 
				 	update="@form :rolesForm" />

				<a href="#" class="button gray size30 right"
					onclick="$('#newRoleModalDialog').dialog('close');">Cancel</a>
			</div>
		</h:form>
	</div>
	
	<script>
	$(function() {
		$('#newRoleModalDialog').dialog({
			autoOpen : false,
			show : 'slide',
			width : 550,
			modal : true,
			resizable : false,
			open : function(event, ui) {
				$(this).children(':first')
					.css('text-align', 'center')
					.css('padding-top', '100px')
					.html('<img src="#{request.contextPath}/resources/images/style/ajax-loader-black.gif" style="vertical-align:middle;"/>');
			}
		});
		$('#newRoleModalDialog').show();
	});
	</script>
</composite:implementation>
</html>