<ui:component
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:post="http://java.sun.com/jsf/composite/components/post">

	<composite:interface>
		<composite:attribute name="uploadFileButtonText" default="Choose File"/>
		<composite:attribute name="fileUploadListenerMethodName" required="true"/>
		<composite:attribute name="fileUploadListenerMethod" method-signature="void #{cc.attrs.fileUploadListenerMethodName}(
			org.primefaces.event.FileUploadEvent)"/>
		<composite:attribute name="toUpdate" default="" />
		<composite:attribute name="uploadButtonStyle" default="btn btn-green" />
		<composite:attribute name="chooseFileLabel" default="Choose File" />
		<composite:attribute name="oncomplete" default="" />
	</composite:interface>
	
	<composite:implementation>
		<span id="#{cc.clientId}">
			<p:fileUpload id="fileUploadFile" 
          		process="@this"
   				style="display: none;"
   				styleClass="fileUploadFile"
				fileUploadListener="#{cc.attrs.fileUploadListenerMethod}"  
	            dragDropSupport="true"
	            fileLimit="1"
	        	auto="true"
	            label="Choose a file"
	            update="#{cc.attrs.toUpdate}"
	            onstart="$('#loaderSimpleFileUpload').show();"
	            oncomplete="$('#loaderSimpleFileUpload').hide(); #{cc.attrs.oncomplete}">
	            <f:attribute name="page" value="#{facesContext.viewRoot.viewId}" />
	        	<f:attribute name="learningContext" value="#{cc.attrs.learningContext}" />
	        	<f:attribute name="service" value="#{cc.attrs.service}" />
            </p:fileUpload>
            <a href="javascript:void(0);" id="linkTriggerSimpleFileUpload" class="#{cc.attrs.uploadButtonStyle}">#{cc.attrs.chooseFileLabel}</a>
	        <img class="loaderSvg" id="loaderSimpleFileUpload" src="#{request.contextPath}/resources/images2/loader.svg" width="20" height="20" style="display:none;"/>
            <script>
            	$('#' + escapeColons('#{cc.clientId}') + ' #linkTriggerSimpleFileUpload').on('click', function(e){
			 		e.stopPropagation();
					$('#' + escapeColons('#{cc.clientId}') + ' .fileUploadFile :input').trigger('click');
				});
            </script>
        </span>
	</composite:implementation>
</ui:component>