<ui:composition 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:goalscomps="http://java.sun.com/jsf/composite/components/goals"
	xmlns:post="http://java.sun.com/jsf/composite/components/post"
	xmlns:goalcomp="http://java.sun.com/jsf/composite/components/goals">
	
	<div class="goalCompWall">
		<h3>Activity Wall</h3>
		
		<ui:param name="courseContext" value="#{learninggoals.selectedGoalData.data.course != null ? 'name:Credential|id:'.concat(learninggoals.selectedGoalData.data.course.id) : ''}" />
		
		<post:newActivityNoForm value="compActivity" 
			content="#{compwall.newActFormData}" 
			createPostAction="#{compwall.createNewPost()}"
			handleFileUpload="#{compwall.handleFileUpload}"
			containerDiv=".goalCompWall" 
			refreshCommand=".goalCompWall a.refreshAllHanler" 
			actionButtonName="add"
			postToStatusWall="#{compwall.newActFormData.connectWithStatus}"
			watermarkTitle="New activity name..."
			watermark="Activity description..."
			regionToRefresh=":activities:compWall:compWall"
			visibilityFixed="#{learninggoals.selectedGoalData.data.visibility}"
			displayLimitedInsteadOfPrivateVisibility="true"
			limitedVisibilityTooltipText="#{msg['learn.goal.composite.visibility.limited']}"
			postStyleClass="wide"
			page="#{facesContext.viewRoot.viewId}"
			learningContext="#{courseContext}|context:/name:learning_goal|id:#{learninggoals.selectedGoalData.data.targetGoalId}|context:/name:competence|id:#{learninggoals.selectedGoalData.selectedCompetence.data.id}//"
		/>
		
		<script>
			$(function() {
				addLoader('.goalCompWall div.compWall', 'Loading activities...');
				refreshCompetenceActivityWall();
			});
			
			function refreshCompetenceActivityWall() {
				$('.goalCompWall a.refreshAllHanler').trigger('click');
			}
		</script>
		
		<goalcomp:compactivitiesNoForm id="compWall" value="compWall"
			loadingMsg="Loading activities..."
			addCommentMsg="Add a comment..."
			allActivities="#{compwall.activities}"
			actionBean="#{cc.attrs.actionBean}"
			initializeHandler="#{compwall.initializeActivities()}"
			page="#{facesContext.viewRoot.viewId}"
			context="learn.targetGoal.#{learninggoals.selectedGoalData.data.targetGoalId}.targetComp.#{learninggoals.selectedGoalData.selectedCompetence.data.id}"
			learningContext="#{courseContext}|context:/name:learning_goal|id:#{learninggoals.selectedGoalData.data.targetGoalId}|context:/name:competence|id:#{learninggoals.selectedGoalData.selectedCompetence.data.id}//"
			activityStyleClass="wide"
		/>
	</div>
</ui:composition>