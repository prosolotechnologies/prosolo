<ui:composition
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:post="http://java.sun.com/jsf/composite/components/post">
	
	<h:panelGroup id="goalWallContainer" layout="block" class="learnMenuContent goalWall" style="display: none;">
		<div class="goalWall twoThirdsColumn learnTripStep9">
		<ui:param name="courseContext" value="#{learninggoals.selectedGoalData.data.course != null ? 'name:Credential|id:'.concat(learninggoals.selectedGoalData.data.course.id) : ''}" />
		<ui:param name="learningContextGoalWall" value="#{courseContext}|context:/name:learning_goal|id:#{learninggoals.selectedGoalData.data.targetGoalId}|context:/name:goal_wall//"></ui:param>
			<h:form id="goalWallTitle">
				<h3 class="title">
					<span class="left">Goal Wall</span>
					
					<h:panelGroup rendered="#{goalwall.userFilterData != null}">
						<span class="left">
						&#160;- filter for&#160;
						</span>
						<span class="name">
							<span class="left">
								#{goalwall.userFilterData.name}
							</span>
							<p:commandLink styleClass="remove"
								onclick="addLoader('form.goalWallForm .goalWall', 'Loading...')"
			    				action="#{goalwall.removeUserFilter()}"
			    				update=":collabCompsForm :goalWallTitle :navigation"
			    				oncomplete="$('form.goalWallForm a.refreshAllHanler').trigger('click')" />
						</span>
					</h:panelGroup>
				</h3>
				<script>
					$('.goalWall .title .filter a.remove').click(function(){
						$('.goalsPage .pageNavigation .collaboratorContainer .shade').removeClass('selected');
					});
				</script>
			</h:form>

			<post:newpost id="goalWallForm" value="goalWallUpdate" 
				content="#{goalwall.newPostData}" 
				createPostAction="#{goalwall.createNewPost()}"
				handleFileUpload="#{goalwall.handleFileUpload}"
				containerDiv=".goalWall"
				refreshCommand="form.goalWallForm a.refreshAllHanler"
				visibilityFixed="#{learninggoals.selectedGoalData.data.visibility}"
				displayLimitedInsteadOfPrivateVisibility="true"
				limitedVisibilityTooltipText="#{msg['learn.goal.composite.visibility.limited']}"
				watermark="Add note to the goal"
				postToStatusWall="#{goalwall.connectNewPostWithStatus}"
				cancelCallback="sendServiceUse('MOUSE_CLICK', {context: 'learn.goalWall.newPost', link: 'cancel', 'targetGoalId' : '#{learninggoals.selectedGoalData.data.targetGoalId}'});"
			/>
			
			<comp:activitywall id="goalWall"
				value="goalWall"
				refreshRate="#{goalwall.refreshRate}"
				moreToLoadIndicator="#{goalwall.moreToLoad}"
				allActivities="#{goalwall.allActivities}"
				refreshHandler="#{goalwall.refresh()}"
				initializeHandler="#{goalwall.initializeActivities()}"
				loadMoreHandler="#{goalwall.loadMoreActivities()}"
				context="learn.goalWall.targetGoal.#{learninggoals.selectedGoalData.data.targetGoalId}"
				initializeOnLoad="false"
				postStyleClass="wide"
				learningContext="#{learningContextGoalWall}"
			/>
		</div><!-- .main end -->
		
		<div class="oneThirdColumn marginLeft30">
			<div class="bottomSeparator50">
				<ui:include src="/resources/components/goals/goalEvaluations.xhtml" />
			</div>
			<div class="clear"></div>
				
			<div class="bottomSeparator50">
				<ui:include src="/resources/components/goals/goalBadges.xhtml" />
			</div>
			<div class="clear"></div>
			
			<div class="bottomSeparator50">
				<ui:include src="/resources/components/goals/goalWallDocuments.xhtml" />
			</div>
		</div>
	</h:panelGroup>
</ui:composition>