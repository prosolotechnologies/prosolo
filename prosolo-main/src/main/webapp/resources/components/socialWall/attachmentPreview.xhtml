<ui:component
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:p="http://primefaces.org/ui"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:icon="http://java.sun.com/jsf/composite/components/resourceLinks/icons"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<composite:interface>
		<composite:attribute name="attachmentPreview"
			type="org.prosolo.web.activitywall.data.AttachmentPreview" />
		<composite:attribute name="styleClass" type="java.lang.String" />
		<composite:attribute name="toRender" default="true" />
		<composite:attribute name="width" default="380" />
		<composite:attribute name="height" default="270" />
		<composite:attribute name="context" />
		<composite:attribute name="uniqueParentSelector" />
	</composite:interface>
	
	<composite:implementation>
		<h:panelGroup layout="block" rendered="#{cc.attrs.toRender}" class="#{cc.attrs.styleClass}">
			<h:panelGroup layout="block" class="richContent"
				rendered="#{cc.attrs.attachmentPreview != null}">
				
				<h:panelGroup layout="block"
					rendered="#{cc.attrs.attachmentPreview != null and cc.attrs.attachmentPreview.contentType != 'RESOURCE' and cc.attrs.attachmentPreview.image != null and cc.attrs.attachmentPreview.image.length() > 0}"
					class="imgInfoContainer imgInfoContainer100">
	
					<h:panelGroup rendered="#{cc.attrs.attachmentPreview.mediaType != 'VIDEO' and cc.attrs.attachmentPreview.mediaType != 'SLIDESHARE'}">
						<div class="atcImages">
							<h:outputLink target="_blank" value="#{cc.attrs.attachmentPreview.link}"
								onclick="sendLogPageNavigationWithParameters('#{cc.attrs.attachmentPreview.link}', {context: '#{cc.attrs.context}.image'});">
								<h:graphicImage rendered="#{cc.attrs.attachmentPreview != null}" 
									value="#{cc.attrs.attachmentPreview != null ? cc.attrs.attachmentPreview.image : '&#160;'}"
									styleClass="imgInfoContainer100"
									alt="&#160;" />
							</h:outputLink>
						</div>
					</h:panelGroup>
				</h:panelGroup>
	
				<h:panelGroup layout="block"
					rendered="#{cc.attrs.attachmentPreview.contentType == 'UPLOAD_ASSIGNMENT'}">
					<strong>Assignment</strong>
					<div class="clear marginBottom10"></div>
				</h:panelGroup>
				
				<h:panelGroup layout="block"
					rendered="#{cc.attrs.attachmentPreview.contentType == 'NONE' and 
									cc.attrs.attachmentPreview.action == 'Registered'}"
					class="welcomeActivity">
					<h4>Welcome to ProSolo!</h4>
					<div class="welcome">Start by setting up your account and and creating your first learning goal.</div>
					<div class="clear marginBottom10"></div>
	
					<h:link
						onclick="sendLogPageNavigationWithParameters('settings/profile', {context: '#{cc.attrs.context}.welcomeActivity'});"
						class="button blue size30" value="Account Settings"
						outcome="/settings">
						<f:param name="tab" value="profile" />
					</h:link>
	
					<h:link
						onclick="sendLogPageNavigationWithParameters('learn', {context: '#{cc.attrs.context}.welcomeActivity'});"
						class="button blue size30 secondButton" value="Learn Page"
						outcome="learn" />
	
					<div class="clear marginBottom10"></div>
				</h:panelGroup>
	
				<h:panelGroup layout="block"
					rendered="#{cc.attrs.attachmentPreview.contentType == 'RESOURCE' or cc.attrs.attachmentPreview.contentType == 'UPLOAD_ASSIGNMENT'}">
					<icon:resource
						type="#{cc.attrs.attachmentPreview.resource.shortType}"
						clazz="#{cc.attrs.attachmentPreview.resource.clazz.toString()}"
						size="30" styleClass="left marginRight10" />
				</h:panelGroup>
	
	
				<h:panelGroup layout="block" id="atcInfo"
					styleClass="actInfo #{(cc.attrs.attachmentPreview.image != null and cc.attrs.attachmentPreview.image.length() > 0) ? 
						'actInfoSmallImgBig' : 
						((cc.attrs.attachmentPreview.contentType == 'RESOURCE' or cc.attrs.attachmentPreview.contentType == 'UPLOAD_ASSIGNMENT') 
							? 'actInfoLogo' : 'actInfoBig')}">
	
					<h:panelGroup layout="block" rendered="#{cc.attrs.attachmentPreview.contentType == 'RESOURCE'}">
						<link:resourceLink
							type="#{cc.attrs.attachmentPreview.resource.shortType}"
							title="#{cc.attrs.attachmentPreview.title}"
							resourceId="#{cc.attrs.attachmentPreview.resource.id}"
							styleClass="bold"
							context="#{cc.attrs.context}" />
					</h:panelGroup>
					
					<h:panelGroup layout="block" rendered="#{cc.attrs.attachmentPreview.contentType != 'RESOURCE'}">
						<h:outputLink rendered="#{cc.attrs.attachmentPreview.link != null and cc.attrs.attachmentPreview.contentType != 'UPLOAD'}"
							onclick="sendLogPageNavigationWithParameters('#{cc.attrs.attachmentPreview.link}', {context: '#{cc.attrs.context}.title'});"
							styleClass="atcTitle" target="_blank"
							value="#{cc.attrs.attachmentPreview.link}">
							<h:outputText value="#{cc.attrs.attachmentPreview.title}" />
						</h:outputLink>

						<h:outputLink rendered="#{cc.attrs.attachmentPreview.link != null and cc.attrs.attachmentPreview.contentType == 'UPLOAD'}"
							onclick="sendLogPageNavigationWithParameters('#{cc.attrs.attachmentPreview.link}', {context: '#{cc.attrs.context}.uploadTitle'});"
							styleClass="atcTitle" target="_blank"
							value="#{cc.attrs.attachmentPreview.link}">
							<h:outputText value="#{cc.attrs.attachmentPreview.uploadTitle}" />
						</h:outputLink>

						<h:panelGroup layout="block" class="marginTop10"
							rendered="#{cc.attrs.attachmentPreview.mediaType == 'VIDEO'}">
							<div id="#{cc.attrs.attachmentPreview.id}" class="youtubevideodiv"></div>
							
							<script>
								$(function(){
									initializeYouTubeAPI({
										width: '#{cc.attrs.width}', 
										height: '#{cc.attrs.height}',
										container: '#{cc.attrs.uniqueParentSelector} .youtubevideodiv',
										context: '#{cc.attrs.context}',
									});
								});
							</script>
						</h:panelGroup>
						
						<h:panelGroup layout="block" class="marginTop10"
							rendered="#{cc.attrs.attachmentPreview.mediaType == 'SLIDESHARE'}">
							<iframe src="#{cc.attrs.attachmentPreview.embedingLink}"
								class="slideshare" width="380" height="270" frameborder="0"
								marginwidth="0" marginheight="0" scrolling="no"
								style="border: 1px solid #CCC; border-width: 1px 1px 0; margin-bottom: 5px"></iframe>
						</h:panelGroup>
	
						<h:panelGroup
							rendered="#{cc.attrs.attachmentPreview.mediaType != 'VIDEO' and cc.attrs.attachmentPreview.mediaType != 'SLIDESHARE'}">
							<h:outputLink
								rendered="#{cc.attrs.attachmentPreview.contentType == 'UPLOAD'}"
								onclick="sendLogPageNavigationWithParameters('#{cc.attrs.attachmentPreview.link}', {context: '#{cc.attrs.context}.link'});"
								styleClass="atcUrl" target="_blank"
								value="#{cc.attrs.attachmentPreview.link}">
								<h:outputText value="#{cc.attrs.attachmentPreview.link}" />
							</h:outputLink>
							
							<h:outputLink
								rendered="#{cc.attrs.attachmentPreview.contentType != 'UPLOAD'}"
								onclick="sendLogPageNavigationWithParameters('#{cc.attrs.attachmentPreview.link}', {context: '#{cc.attrs.context}.link'});"
								styleClass="atcUrl" target="_blank"
								value="#{cc.attrs.attachmentPreview.link}">
								<h:outputText
									value="#{util:getDomainFromUrl(cc.attrs.attachmentPreview.link)}" />
							</h:outputLink>
						</h:panelGroup>
					</h:panelGroup>
					<div class="clear"></div>
	
					<p class="atcDesc" context="#{cc.attrs.context}">
						<h:outputText rendered="#{cc.attrs.attachmentPreview.contentType != 'UPLOAD'}" 
							value="#{cc.attrs.attachmentPreview.description}" escape="false" />

						<h:outputText rendered="#{cc.attrs.attachmentPreview.contentType == 'UPLOAD'}" 
							value="#{cc.attrs.attachmentPreview.uploadDescription}"	escape="false" />
					</p>
				</h:panelGroup>
			</h:panelGroup>
		</h:panelGroup>
	</composite:implementation>
</ui:component>