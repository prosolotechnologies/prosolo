<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="templates/masterLayout1.xhtml"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:link="http://java.sun.com/jsf/composite/components/resourceLinks"
	xmlns:icon="http://java.sun.com/jsf/composite/components/resourceLinks/icons"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:mngComp="http://java.sun.com/jsf/composite/components/manage">

<ui:define name="windowTitle">
	External Tools
</ui:define>

<ui:define name="metadata">
	<f:metadata>
		<f:viewParam name="credId" value="#{manageExternalToolsBean.cred}" default="null"/>
		<f:viewParam name="compId" value="#{manageExternalToolsBean.comp}" default="null"/>
		<f:viewParam name="actId" value="#{manageExternalToolsBean.act}" default="null"/>
		<f:viewAction action="#{manageExternalToolsBean.init()}" />
	</f:metadata>
</ui:define>

<ui:define name="content">

	<mngComp:competenceHeader id="competenceHeader"
       	competenceName="#{manageExternalToolsBean.competenceTitle}"
       	competenceEncodedId="#{param['compId']}"
       	activeLink="External Tools"
       	origin="#{empty param['origin'] ? '/manage/competences' : param['origin']}" />
       	
	<section>
		<div class="subHeader">
			<h3 class="title">External Tools</h3>
			
			<h:link id= "linkNewTool"
				pt:role="button"
				styleClass="btn btn-primary panelButton pull-right"
				value="New External Tool" 
				outcome="/manage/externalTools/toolDetails">
				<f:param name="credId" value="#{manageExternalToolsBean.cred}" />
				<f:param name="compId" value="#{util:encodeId(manageExternalToolsBean.currentCompetence)}" />
				<f:param name="actId" value="#{util:encodeId(manageExternalToolsBean.currentActivity)}" />
			</h:link>
		</div>
	</section>
	
	<section class="container-fluid mainArea fullWidth">
		<div class="row fullWidthPanel">
			<div class="panel panel-default">
				<div class="row">
					<div class="col-md-12">
					
						<h:form id="toolsForm">
							<p:growl id="externalToolsGrowl" showDetail="true" />
						
							<table class="panel table tableProsolo">
								<thead>
									<tr>
										<th class="colNo" scope="col">
											No.
										</th>
										<th class="colStudent" scope="col">
									    	Title
										</th>
										<th class="colEmail" scope="col">
									    	Info
										</th>
										<th class="colEmail" scope="col">
									    	Resource Type
										</th>
										<th class="colActions" scope="col">
									    	Actions
										</th>
									</tr>
								</thead>
								<tbody>
									<ui:repeat var="tool" value="#{manageExternalToolsBean.externalTools}" varStatus="iterator">
										<tr>
											<td class="colNoD">#{status.index + 1}.</td>
											<td class="colStudentD">
												<h:link outcome="/manage/externalTools/toolDetails" 
													value="#{tool.title}">
													<f:param  name="id" value="#{util:encodeId(tool.id)}" action="" />
												</h:link>
											</td>
											<td class="colProfileD">
											</td>
											<td class="colProfileD">
												#{tool.resType}
											</td>
											<td class="actions">
												<h:link outcome="/manage/externalTools/toolDetails" 
													pt:role="button"
													styleClass="btn btn-info"
													value="Edit">
													<f:param name="id" value="#{util:encodeId(tool.id)}" />
												</h:link>
												
												<p:commandLink
													value="#{manageExternalToolsBean.setEnabledButton(tool)}"
													pt:role="button"
													styleClass="btn btn-default"
													action="#{manageExternalToolsBean.changeEnabled(tool)}"
													update="@this :toolsForm:externalToolsGrowl"
												/>
												
												<p:commandLink 
													value="Delete"
													pt:role="button"
													styleClass="btn btn-danger"
													action="#{manageExternalToolsBean.deleteTool(tool)}"
													update=":toolsForm :toolsForm:externalToolsGrowl"
												/>
											</td>
										</tr>
									</ui:repeat>
								</tbody>
							</table>
						</h:form>
					</div>
				</div>
			</div>
		</div>
	</section>
</ui:define>

</ui:composition>