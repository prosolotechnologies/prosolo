<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:comp="http://java.sun.com/jsf/composite/components"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:util="http://www.prosolo.com/util"
	xmlns:dlg="http://java.sun.com/jsf/composite/components/dialogs"
	xmlns:dlgAnalytics="http://java.sun.com/jsf/composite/components/dialogs/analytics"
	xmlns:utilcomp="http://java.sun.com/jsf/composite/components/util">

<ui:insert name="metadata" />

<h:head>
	<f:facet name="first">
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<link rel="icon" href="#{request.contextPath}/favicon.ico" type="image/x-icon" />
		<title><ui:insert name="windowTitle" /></title>
	</f:facet>
	
	<link rel="stylesheet" type="text/css" media="all" href="#{request.contextPath}/resources/css/prosolo-theme/jquery-ui-1.8.21.custom.css" />
	<link rel="stylesheet" type="text/css" media="all" href="#{request.contextPath}/resources/css/jquery.qtip.min.css" />
	<link rel="stylesheet" type="text/css" media="all" href="#{request.contextPath}/resources/css/style.css?#{loggeduser.loginTime}" />
	
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" />
 	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,400italic,600italic,800' rel='stylesheet' type='text/css' />
	
	<script src="#{request.contextPath}/resources/javascript/jquery-ui-1.11.2.min.js"></script>
	<script src="#{request.contextPath}/resources/javascript/jquery.ui.dialog.closeOnClickOutside.min.js"></script>
	<script src="#{request.contextPath}/resources/javascript/custom.js"></script>
	<script	src="#{request.contextPath}/resources/javascript/readmore.custom.js"></script>
	<script	src="#{request.contextPath}/resources/javascript/jquery.moreLessBox.js"></script>
	<script	src="#{request.contextPath}/resources/javascript/jquery.qtip.min.js"></script>
	<script	src="#{request.contextPath}/resources/javascript/jquery.qtip.prosolo.js"></script>
	
	<script	src="#{request.contextPath}/resources/javascript/prosolo.tabs.js"></script>
	<script	src="#{request.contextPath}/resources/javascript/prosolo.bigTooltipControl.js"></script>
	<script	src="#{request.contextPath}/resources/javascript/prosolo.logging.js"></script>
	
	<script src="https://www.youtube.com/iframe_api"/>
	<script	src="#{request.contextPath}/resources/javascript/youtubevideo.js"></script>
</h:head>

<h:body>
	<utilcomp:messagesBundle var="msg" />
	
	<h:outputScript library="javascript" name="jquery.shortenedText.js" target="head"/>

	<div>
		<div id="headerWrapper">
			<div class="header">
				<div id="headerLeft">
					<div class="mainLogos">
						<h:link
							onclick="sendLogPageNavigation( '/manage/courses', 'mainmenu');" 
							outcome="/manage/courses">
							<span class="secManage"></span>
						</h:link>
						
						<h:panelGroup layout="block" rendered="#{loggeduser.hasCapability('basic.manager.access') 
								or loggeduser.hasCapability('basic.admin.access')}">
							<a class="arrow" href="javascript:void(0);">
								<i class="fa fa-angle-down"></i>
							</a>
							
							<div class="dropdown hidden">
								<ul>
									<li>
										<h:link 
											onclick="sendLogPageNavigation('index','mainmenu');" 
											outcome="/index">
											<span class="logo"></span>
										</h:link>
									</li>
									<li>
										<h:link rendered="#{loggeduser.hasCapability('basic.admin.access')}"
											onclick="sendLogPageNavigation( '/admin/users', 'mainmenu');"
											outcome="/admin/users">
											<span class="secAdmin"></span>
										</h:link>
									</li>
								</ul>
							</div>
						</h:panelGroup>
					</div>
					
					<ul class="navigation"> 
						<li class="#{util:matchPageURLRegex('/manage/competences(.*?)') ? 'selected' : ''}">
							<h:link rendered="#{loggeduser.hasCapability('competences.view')}"
								onclick="sendLogPageNavigation('/manage/competences','mainmenu');"
								value="Competences"
								outcome="/manage/competences" />
						</li>
						<li class="#{util:matchPageURLRegex('/manage/course(.*?)') ? 'selected' : ''}">
							<h:link rendered="#{loggeduser.hasCapability('basic.manager.access')}"
								onclick="sendLogPageNavigation('/manage/courses','mainmenu');"
								value="#{msg['manager.mainmenu.courses']}"
								outcome="/manage/courses" />
						</li>
						<li class="#{util:matchPageURLRegex('/manage/reports') ? 'selected' : ''}">
							<h:link rendered="#{loggeduser.hasCapability('reports.view')}"
								onclick="sendLogPageNavigation('/manage/reports','mainmenu');"
								value="Reports"
								outcome="/manage/reports" />
						</li>
					</ul>
				</div>
				
				<div id="headerRight">
					<div id="name">
						<a class="arrow" href="javascript:void(0);">
							<h:panelGroup id="avatarContainer">
								<span class="headerAvatar">
									<h:graphicImage styleClass="imageRound image30"
										value="#{profileSettings.accountData.avatarPath}"
										width="30" height="30" alt="" />
								</span>
							</h:panelGroup>
							
							<h:panelGroup id="userNameContainer">
								<h:outputText id="userName" value="#{loggeduser.name} #{loggeduser.lastName}" />
								<script>
									$('#userName').shortenedText({
										mode : 'show-first-word',
										showChar : 12
									})
								</script>
							</h:panelGroup>
							<i class="fa fa-angle-down"></i>
						</a>
							
						<div class="dropdown hidden">
							<ul>
								<h:form id="userLogoutFormId">
									<li>
										<h:link 
											onclick="sendLogPageNavigation('diggest','mainmenu');" 
											value="Digest" 
											outcome="/digest" />
									</li>
									<li>
										<h:link 
											onclick="sendLogPageNavigation('communications','mainmenu');" 
											value="Communications" 
											outcome="/communications" />
									</li>
									<li>
										<h:link 
											onclick="sendLogPageNavigation('search','mainmenu');" 
											value="Search" 
											outcome="/search" />
									</li>
									<li>
										<h:link 
											onclick="sendLogPageNavigation('settings','mainmenu');" 
											value="Settings" 
											outcome="/settings" />
									</li>
									<li>
										<h:commandLink id="userLogout" 
											value="Logout" 
											action="#{loggeduser.userLogout()}">
										</h:commandLink>
									</li>
									<ui:remove>
										<li>
											<a href="#{request.contextPath}/logout">Logout</a>
										</li>
									</ui:remove>
								</h:form>
							</ul>
						</div>
					</div>
					
					<div class="mainMenuButtons indexTripStep7 indexTripStep8" position="s">
						<ui:include	src="/resources/components/topmenunotifications.xhtml" />
						<ui:include	src="/resources/components/topmenuinbox.xhtml" />
						<ui:include src="/resources/components/topmenusearch.xhtml" />
					</div>
				</div>
		</div>
		</div>
		<!-- #headerWrapper end -->
		
		<ui:insert name="content" />
		<!-- .container end -->
		
		<comp:footer />
	</div>
	
	<dlg:appendedActivities id="appActivities"/>
	<!--  dlg:addToCompetence id="addToCompetence"/-->
	<ui:include	src="/resources/components/dialogs/addToCompetence.xhtml" />
	<dlg:addToGoal id="addToGoal" />
	<ui:include	src="/resources/components/dialogs/newPostDialog.xhtml" />
	<ui:include	src="/resources/components/dialogs/peopleListDialog.xhtml" />
	<ui:include	src="/resources/components/dialogs/userDetailsData.xhtml" />
	<ui:include	src="/resources/components/dialogs/newDirectMessage.xhtml" />
	<ui:include src="/resources/components/dialogs/activityDetails.xhtml" />
	<ui:include src="/resources/components/dialogs/compDetailsDialog.xhtml" />
	<ui:include	src="/resources/components/dialogs/goalDetailsDialog.xhtml" />
	
	<dlgAnalytics:activity id="actAnalytics" />
</h:body>

</html>